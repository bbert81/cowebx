<!DOCTYPE html> 
<html>
  	<head>
		<title>OpenCoweb Application with Persistence</title>
		<link href="http://fonts.googleapis.com/css?family=Amaranth:400,700" rel="stylesheet" type="text/css" />
		<link rel="stylesheet" href="about.css" type="text/css" />
		<link href="google-code-prettify/prettify.css" type="text/css" rel="stylesheet" />
		<script type="text/javascript" src="google-code-prettify/prettify.js"></script>
  	</head>
	<body onload="prettyPrint()">
		<div class="title">OpenCoweb Application with Persistence</div>
		<div class="entry titleSub">A step-by-step walkthrough on making a collaborative application with persistence using the Open Cooperative Web Framework. <!-- There are two parts to the guide - the <a href="#client"><b>client</b></a> and the <a href="#server"><b>server</b></a>. --></div>

		<!-- <div name="client" class="bigTitle">The Client</div> -->
		<div class="subTitle">1. Build the Client</div>
		<div class="entry">
			The first step to building an collaborative application is to create the client-side user interface. A <a href="http://opencoweb.org/ocwdocs/tutorial/shopping.html">great tutorial</a> is available within the <a href="http://opencoweb.org/ocwdocs/">OpenCoweb documentation</a>.
		</div>
		<br><br>
		<div class="subTitle">2. Build Java Moderator Class</div>
		<div class="entry">
			The next step is to write the actual Moderator class for your application. It should extend the <b>DefaultSessionModerator</b> class that is found within <b>coweb/servers/java/coweb-server/src/main/java/org/coweb</b>. Methods should be overridden to suit your application's needs. A list of the methods available to you is below. For full documentation on the Moderator API, <a href="#">click here</a>.
		</div>
<pre class="prettyprint code">
public boolean onSync(Map<String, Object> data) { }

public Object[] getLateJoinState() { }

public boolean canClientJoinSession(ServerSession client) { }

public void onClientJoinSession(ServerSession client) { }

public void onClientLeaveSession(ServerSession client) { }

public boolean canClientSubscribeService(ServerSession client) { }

public boolean canClientMakeServiceRequest(ServerSession client, Message botMessage) { }

public void onServiceResponse(Message botResponse) { }

public void onSessionEnd() { }
</pre>
		<br><br>
		<div class="subTitle">3. Turn On Moderator Model</div>
		<div class="entry">
			Next, we need to activate this moderator model, and tell the application that this class will be the updater for late-joiners. This is done by simply adding a simple .json file called <b>cowebConfig.json</b> to your application's WEB-INF folder, with the following name/value pairs.
		</div>
<pre class="prettyprint code">
{ 
  // Full java classname of moderator class
  "sessionModerator"   : "org.coweb.CotreeModerator",
  // Turns on moderator model
  "moderatorIsUpdater" : true,
  // Events are transformed
  "operationEngine"    : true,
  // An array of bot configs (optional)
  "bots": [] 
}
</pre>
	<br><br>
	<div class="subTitle">4. Celebrate</div>
	<div class="entry">
		That's it. All events now go through your Moderator class, allowing you to keep state server-side however you see fit for your application, whether it's maintaining a complex object, as in the Cotree demo, or pushing syncs into a remote database. Either way, when a new member comes into the session, your Moderator can give that user whatever state you choose.
	</div>
<br><br>
  	</body>
</html>
