/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/window","./ChartAction","./_IndicatorElement","dojox/lang/utils"],function(_1,_2,_3,_4,_5,_6,du){return _1.declare("dojox.charting.action2d.MouseIndicator",dojox.charting.action2d.ChartAction,{defaultParams:{series:null,vertical:true,autoScroll:true,fixed:true,precision:0},optionalParams:{lineStroke:{},outlineStroke:{},shadowStroke:{},stroke:{},outline:{},shadow:{},fill:{},fillFunc:null,labelFunc:null,font:"",fontColor:"",markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerSymbol:""},constructor:function(_7,_8,_9){this._listeners=[{eventName:"onmousedown",methodName:"onMouseDown"}];this.opt=_1.clone(this.defaultParams);du.updateWithObject(this.opt,_9);du.updateWithPattern(this.opt,_9,this.optionalParams);this.uName="mouseIndicator"+this.opt.series;this._handles=[];this.connect();},_disconnectHandles:function(){if(_1.isIE){this.chart.node.releaseCapture();}_1.forEach(this._handles,_1.disconnect);this._handles=[];},connect:function(){this.inherited(arguments);this.chart.addPlot(this.uName,{type:_6,inter:this});},disconnect:function(){if(this._isMouseDown){this.onMouseUp();}this.chart.removePlot(this.uName);this.inherited(arguments);this._disconnectHandles();},onMouseDown:function(_a){this._isMouseDown=true;if(_1.isIE){this._handles.push(_1.connect(this.chart.node,"onmousemove",this,"onMouseMove"));this._handles.push(_1.connect(this.chart.node,"onmouseup",this,"onMouseUp"));this.chart.node.setCapture();}else{this._handles.push(_1.connect(_1.doc,"onmousemove",this,"onMouseMove"));this._handles.push(_1.connect(_1.doc,"onmouseup",this,"onMouseUp"));}this._onMouseSingle(_a);},onMouseMove:function(_b){if(this._isMouseDown){this._onMouseSingle(_b);}},_onMouseSingle:function(_c){var _d=this.chart.getPlot(this.uName);_d.pageCoord={x:_c.pageX,y:_c.pageY};_d.dirty=true;this.chart.render();_1.stopEvent(_c);},onMouseUp:function(_e){var _f=this.chart.getPlot(this.uName);_f.stopTrack();this._isMouseDown=false;this._disconnectHandles();_f.pageCoord=null;_f.dirty=true;this.chart.render();}});});