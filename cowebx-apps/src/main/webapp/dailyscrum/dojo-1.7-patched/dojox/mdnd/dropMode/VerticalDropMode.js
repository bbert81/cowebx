/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo","dijit","dojox","dojox/mdnd/AreaManager"],function(_1,_2,_3){_1.getObject("dojox.mdnd.dropMode.VerticalDropMode",1);_1.declare("dojox.mdnd.dropMode.VerticalDropMode",null,{_oldXPoint:null,_oldYPoint:null,_oldBehaviour:"up",addArea:function(_4,_5){var _6=_4.length;var _7=_1.position(_5.node,true);_5.coords={"x":_7.x,"y":_7.y};if(_6==0){_4.push(_5);}else{var x=_5.coords.x;for(var i=0;i<_6;i++){if(x<_4[i].coords.x){for(var j=_6-1;j>=i;j--){_4[j+1]=_4[j];}_4[i]=_5;break;}}if(i==_6){_4.push(_5);}}return _4;},updateAreas:function(_8){var _9=_8.length;if(_9>1){var _a,_b;for(var i=0;i<_9;i++){var _c=_8[i];var _d;_c.coords.x1=-1;_c.coords.x2=-1;if(i==0){_d=_8[i+1];this._updateArea(_c);this._updateArea(_d);_a=_c.coords.x+_c.node.offsetWidth;_b=_d.coords.x;_c.coords.x2=_a+(_b-_a)/2;}else{if(i==_9-1){_c.coords.x1=_8[i-1].coords.x2;}else{_d=_8[i+1];this._updateArea(_d);_a=_c.coords.x+_c.node.offsetWidth;_b=_d.coords.x;_c.coords.x1=_8[i-1].coords.x2;_c.coords.x2=_a+(_b-_a)/2;}}}}},_updateArea:function(_e){var _f=_1.position(_e.node,true);_e.coords.x=_f.x;_e.coords.y=_f.y;},initItems:function(_10){_1.forEach(_10.items,function(obj){var _11=obj.item.node;var _12=_1.position(_11,true);var y=_12.y+_12.h/2;obj.y=y;});_10.initItems=true;},refreshItems:function(_13,_14,_15,_16){if(_14==-1){return;}else{if(_13&&_15&&_15.h){var _17=_15.h;if(_13.margin){_17+=_13.margin.t;}var _18=_13.items.length;for(var i=_14;i<_18;i++){var _19=_13.items[i];if(_16){_19.y+=_17;}else{_19.y-=_17;}}}}},getDragPoint:function(_1a,_1b,_1c){var y=_1a.y;if(this._oldYPoint){if(y>this._oldYPoint){this._oldBehaviour="down";y+=_1b.h;}else{if(y<=this._oldYPoint){this._oldBehaviour="up";}}}this._oldYPoint=y;return {"x":_1a.x+(_1b.w/2),"y":y};},getTargetArea:function(_1d,_1e,_1f){var _20=0;var x=_1e.x;var end=_1d.length;if(end>1){var _21=0,_22="right",_23=false;if(_1f==-1||arguments.length<3){_23=true;}else{if(this._checkInterval(_1d,_1f,x)){_20=_1f;}else{if(this._oldXPoint<x){_21=_1f+1;}else{_21=_1f-1;end=0;_22="left";}_23=true;}}if(_23){if(_22==="right"){for(var i=_21;i<end;i++){if(this._checkInterval(_1d,i,x)){_20=i;break;}}}else{for(var i=_21;i>=end;i--){if(this._checkInterval(_1d,i,x)){_20=i;break;}}}}}this._oldXPoint=x;return _20;},_checkInterval:function(_24,_25,x){var _26=_24[_25].coords;if(_26.x1==-1){if(x<=_26.x2){return true;}}else{if(_26.x2==-1){if(x>_26.x1){return true;}}else{if(_26.x1<x&&x<=_26.x2){return true;}}}return false;},getDropIndex:function(_27,_28){var _29=_27.items.length;var _2a=_27.coords;var y=_28.y;if(_29>0){for(var i=0;i<_29;i++){if(y<_27.items[i].y){return i;}else{if(i==_29-1){return -1;}}}}return -1;},destroy:function(){}});(function(){_3.mdnd.areaManager()._dropMode=new _3.mdnd.dropMode.VerticalDropMode();}());});require(["dojox/mdnd/dropMode/VerticalDropMode"]);