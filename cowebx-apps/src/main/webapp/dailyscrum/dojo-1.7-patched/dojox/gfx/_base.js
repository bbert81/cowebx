/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo/_base/kernel","dojo/_base/html","dojo/_base/Color"],function(_1){_1.getObject("gfx._base",true,dojox);var g=dojox.gfx,b=g._base;g._hasClass=function(_2,_3){var _4=_2.getAttribute("className");return _4&&(" "+_4+" ").indexOf(" "+_3+" ")>=0;};g._addClass=function(_5,_6){var _7=_5.getAttribute("className")||"";if(!_7||(" "+_7+" ").indexOf(" "+_6+" ")<0){_5.setAttribute("className",_7+(_7?" ":"")+_6);}};g._removeClass=function(_8,_9){var _a=_8.getAttribute("className");if(_a){_8.setAttribute("className",_a.replace(new RegExp("(^|\\s+)"+_9+"(\\s+|$)"),"$1$2"));}};b._getFontMeasurements=function(){var _b={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};var p;if(_1.isIE){_1.doc.documentElement.style.fontSize="100%";}var _c=_1.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},_1.body());for(p in _b){_c.style.fontSize=p;_b[p]=Math.round(_c.offsetHeight*12/16)*16/12/1000;}_1.body().removeChild(_c);return _b;};var _d=null;b._getCachedFontMeasurements=function(_e){if(_e||!_d){_d=b._getFontMeasurements();}return _d;};var _f=null,_10={};b._getTextBox=function(_11,_12,_13){var m,s,al=arguments.length;var i;if(!_f){_f=_1.create("div",{style:{position:"absolute",top:"-10000px",left:"0"}},_1.body());}m=_f;m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(al>1&&_12){for(i in _12){if(i in _10){continue;}s[i]=_12[i];}}if(al>2&&_13){m.className=_13;}m.innerHTML=_11;if(m["getBoundingClientRect"]){var bcr=m.getBoundingClientRect();return {l:bcr.left,t:bcr.top,w:bcr.width||(bcr.right-bcr.left),h:bcr.height||(bcr.bottom-bcr.top)};}else{return _1.marginBox(m);}};var _14=0;b._getUniqueId=function(){var id;do{id=_1._scopeName+"Unique"+(++_14);}while(_1.byId(id));return id;};_1.mixin(dojox.gfx,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:false,kerning:true},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:false,kerning:true},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:(function(){var _15={};return function(_16){var t=_15[_16];if(t){return new t();}t=_15[_16]=new Function();t.prototype=dojox.gfx["default"+_16];return new t();};})(),normalizeColor:function(_17){return (_17 instanceof _1.Color)?_17:new _1.Color(_17);},normalizeParameters:function(_18,_19){var x;if(_19){var _1a={};for(x in _18){if(x in _19&&!(x in _1a)){_18[x]=_19[x];}}}return _18;},makeParameters:function(_1b,_1c){var i=null;if(!_1c){return _1.delegate(_1b);}var _1d={};for(i in _1b){if(!(i in _1d)){_1d[i]=_1.clone((i in _1c)?_1c[i]:_1b[i]);}}return _1d;},formatNumber:function(x,_1e){var val=x.toString();if(val.indexOf("e")>=0){val=x.toFixed(4);}else{var _1f=val.indexOf(".");if(_1f>=0&&val.length-_1f>5){val=x.toFixed(4);}}if(x<0){return val;}return _1e?" "+val:val;},makeFontString:function(_20){return _20.style+" "+_20.variant+" "+_20.weight+" "+_20.size+" "+_20.family;},splitFontString:function(str){var _21=dojox.gfx.getDefault("Font");var t=str.split(/\s+/);do{if(t.length<5){break;}_21.style=t[0];_21.variant=t[1];_21.weight=t[2];var i=t[3].indexOf("/");_21.size=i<0?t[3]:t[3].substring(0,i);var j=4;if(i<0){if(t[4]=="/"){j=6;}else{if(t[4].charAt(0)=="/"){j=5;}}}if(j<t.length){_21.family=t.slice(j).join(" ");}}while(false);return _21;},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return dojox.gfx._base._getCachedFontMeasurements()["12pt"]/12;},pt2px:function(len){return len*dojox.gfx.px_in_pt();},px2pt:function(len){return len/dojox.gfx.px_in_pt();},normalizedLength:function(len){if(len.length===0){return 0;}if(len.length>2){var _22=dojox.gfx.px_in_pt();var val=parseFloat(len);switch(len.slice(-2)){case "px":return val;case "pt":return val*_22;case "in":return val*72*_22;case "pc":return val*12*_22;case "mm":return val*dojox.gfx.mm_in_pt*_22;case "cm":return val*dojox.gfx.cm_in_pt*_22;}}return parseFloat(len);},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-Za-z])|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,equalSources:function(a,b){return a&&b&&a===b;},switchTo:function(_23){var ns=typeof _23=="string"?dojox.gfx[_23]:_23;if(ns){_1.forEach(["Group","Rect","Ellipse","Circle","Line","Polyline","Image","Text","Path","TextPath","Surface","createSurface","fixTarget"],function(_24){dojox.gfx[_24]=ns[_24];});}}});});