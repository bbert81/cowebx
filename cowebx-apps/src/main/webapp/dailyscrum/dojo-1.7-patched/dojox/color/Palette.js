/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo/_base/lang","./_base"],function(_1,_2){var _2=dojox.color;_2.Palette=function(_3){this.colors=[];if(_3 instanceof dojox.color.Palette){this.colors=_3.colors.slice(0);}else{if(_3 instanceof dojox.color.Color){this.colors=[null,null,_3,null,null];}else{if(_1.isArray(_3)){this.colors=_1.map(_3.slice(0),function(_4){if(_1.isString(_4)){return new dojox.color.Color(_4);}return _4;});}else{if(_1.isString(_3)){this.colors=[null,null,new dojox.color.Color(_3),null,null];}}}}};function _5(p,_6,_7){var _8=new dojox.color.Palette();_8.colors=[];_1.forEach(p.colors,function(_9){var r=(_6=="dr")?_9.r+_7:_9.r,g=(_6=="dg")?_9.g+_7:_9.g,b=(_6=="db")?_9.b+_7:_9.b,a=(_6=="da")?_9.a+_7:_9.a;_8.colors.push(new dojox.color.Color({r:Math.min(255,Math.max(0,r)),g:Math.min(255,Math.max(0,g)),b:Math.min(255,Math.max(0,b)),a:Math.min(1,Math.max(0,a))}));});return _8;};function _a(p,_b,_c){var _d=new dojox.color.Palette();_d.colors=[];_1.forEach(p.colors,function(_e){var o=_e.toCmy(),c=(_b=="dc")?o.c+_c:o.c,m=(_b=="dm")?o.m+_c:o.m,y=(_b=="dy")?o.y+_c:o.y;_d.colors.push(dojox.color.fromCmy(Math.min(100,Math.max(0,c)),Math.min(100,Math.max(0,m)),Math.min(100,Math.max(0,y))));});return _d;};function _f(p,_10,val){var ret=new dojox.color.Palette();ret.colors=[];_1.forEach(p.colors,function(_11){var o=_11.toCmyk(),c=(_10=="dc")?o.c+val:o.c,m=(_10=="dm")?o.m+val:o.m,y=(_10=="dy")?o.y+val:o.y,k=(_10=="dk")?o.b+val:o.b;ret.colors.push(dojox.color.fromCmyk(Math.min(100,Math.max(0,c)),Math.min(100,Math.max(0,m)),Math.min(100,Math.max(0,y)),Math.min(100,Math.max(0,k))));});return ret;};function _12(p,_13,val){var ret=new dojox.color.Palette();ret.colors=[];_1.forEach(p.colors,function(_14){var o=_14.toHsl(),h=(_13=="dh")?o.h+val:o.h,s=(_13=="ds")?o.s+val:o.s,l=(_13=="dl")?o.l+val:o.l;ret.colors.push(dojox.color.fromHsl(h%360,Math.min(100,Math.max(0,s)),Math.min(100,Math.max(0,l))));});return ret;};function _15(p,_16,val){var ret=new dojox.color.Palette();ret.colors=[];_1.forEach(p.colors,function(_17){var o=_17.toHsv(),h=(_16=="dh")?o.h+val:o.h,s=(_16=="ds")?o.s+val:o.s,v=(_16=="dv")?o.v+val:o.v;ret.colors.push(dojox.color.fromHsv(h%360,Math.min(100,Math.max(0,s)),Math.min(100,Math.max(0,v))));});return ret;};function _18(val,low,_19){return _19-((_19-val)*((_19-low)/_19));};_1.extend(_2.Palette,{transform:function(_1a){var fn=_5;if(_1a.use){var use=_1a.use.toLowerCase();if(use.indexOf("hs")==0){if(use.charAt(2)=="l"){fn=_12;}else{fn=_15;}}else{if(use.indexOf("cmy")==0){if(use.charAt(3)=="k"){fn=_f;}else{fn=_a;}}}}else{if("dc" in _1a||"dm" in _1a||"dy" in _1a){if("dk" in _1a){fn=_f;}else{fn=_a;}}else{if("dh" in _1a||"ds" in _1a){if("dv" in _1a){fn=_15;}else{fn=_12;}}}}var _1b=this;for(var p in _1a){if(p=="use"){continue;}_1b=fn(_1b,p,_1a[p]);}return _1b;},clone:function(){return new _2.Palette(this);}});_1.mixin(_2.Palette,{generators:{analogous:function(_1c){var _1d=_1c.high||60,low=_1c.low||18,_1e=_1.isString(_1c.base)?new dojox.color.Color(_1c.base):_1c.base,hsv=_1e.toHsv();var h=[(hsv.h+low+360)%360,(hsv.h+Math.round(low/2)+360)%360,hsv.h,(hsv.h-Math.round(_1d/2)+360)%360,(hsv.h-_1d+360)%360];var s1=Math.max(10,(hsv.s<=95)?hsv.s+5:(100-(hsv.s-95))),s2=(hsv.s>1)?hsv.s-1:21-hsv.s,v1=(hsv.v>=92)?hsv.v-9:Math.max(hsv.v+9,20),v2=(hsv.v<=90)?Math.max(hsv.v+5,20):(95+Math.ceil((hsv.v-90)/2)),s=[s1,s2,hsv.s,s1,s1],v=[v1,v2,hsv.v,v1,v2];return new _2.Palette(_1.map(h,function(hue,i){return dojox.color.fromHsv(hue,s[i],v[i]);}));},monochromatic:function(_1f){var _20=_1.isString(_1f.base)?new dojox.color.Color(_1f.base):_1f.base,hsv=_20.toHsv();var s1=(hsv.s-30>9)?hsv.s-30:hsv.s+30,s2=hsv.s,v1=_18(hsv.v,20,100),v2=(hsv.v-20>20)?hsv.v-20:hsv.v+60,v3=(hsv.v-50>20)?hsv.v-50:hsv.v+30;return new _2.Palette([dojox.color.fromHsv(hsv.h,s1,v1),dojox.color.fromHsv(hsv.h,s2,v3),_20,dojox.color.fromHsv(hsv.h,s1,v3),dojox.color.fromHsv(hsv.h,s2,v2)]);},triadic:function(_21){var _22=_1.isString(_21.base)?new dojox.color.Color(_21.base):_21.base,hsv=_22.toHsv();var h1=(hsv.h+57+360)%360,h2=(hsv.h-157+360)%360,s1=(hsv.s>20)?hsv.s-10:hsv.s+10,s2=(hsv.s>90)?hsv.s-10:hsv.s+10,s3=(hsv.s>95)?hsv.s-5:hsv.s+5,v1=(hsv.v-20>20)?hsv.v-20:hsv.v+20,v2=(hsv.v-30>20)?hsv.v-30:hsv.v+30,v3=(hsv.v-30>70)?hsv.v-30:hsv.v+30;return new _2.Palette([dojox.color.fromHsv(h1,s1,hsv.v),dojox.color.fromHsv(hsv.h,s2,v2),_22,dojox.color.fromHsv(h2,s2,v1),dojox.color.fromHsv(h2,s3,v3)]);},complementary:function(_23){var _24=_1.isString(_23.base)?new dojox.color.Color(_23.base):_23.base,hsv=_24.toHsv();var h1=((hsv.h*2)+137<360)?(hsv.h*2)+137:Math.floor(hsv.h/2)-137,s1=Math.max(hsv.s-10,0),s2=_18(hsv.s,10,100),s3=Math.min(100,hsv.s+20),v1=Math.min(100,hsv.v+30),v2=(hsv.v>20)?hsv.v-30:hsv.v+30;return new _2.Palette([dojox.color.fromHsv(hsv.h,s1,v1),dojox.color.fromHsv(hsv.h,s2,v2),_24,dojox.color.fromHsv(h1,s3,v2),dojox.color.fromHsv(h1,hsv.s,hsv.v)]);},splitComplementary:function(_25){var _26=_1.isString(_25.base)?new dojox.color.Color(_25.base):_25.base,_27=_25.da||30,hsv=_26.toHsv();var _28=((hsv.h*2)+137<360)?(hsv.h*2)+137:Math.floor(hsv.h/2)-137,h1=(_28-_27+360)%360,h2=(_28+_27)%360,s1=Math.max(hsv.s-10,0),s2=_18(hsv.s,10,100),s3=Math.min(100,hsv.s+20),v1=Math.min(100,hsv.v+30),v2=(hsv.v>20)?hsv.v-30:hsv.v+30;return new _2.Palette([dojox.color.fromHsv(h1,s1,v1),dojox.color.fromHsv(h1,s2,v2),_26,dojox.color.fromHsv(h2,s3,v2),dojox.color.fromHsv(h2,hsv.s,hsv.v)]);},compound:function(_29){var _2a=_1.isString(_29.base)?new dojox.color.Color(_29.base):_29.base,hsv=_2a.toHsv();var h1=((hsv.h*2)+18<360)?(hsv.h*2)+18:Math.floor(hsv.h/2)-18,h2=((hsv.h*2)+120<360)?(hsv.h*2)+120:Math.floor(hsv.h/2)-120,h3=((hsv.h*2)+99<360)?(hsv.h*2)+99:Math.floor(hsv.h/2)-99,s1=(hsv.s-40>10)?hsv.s-40:hsv.s+40,s2=(hsv.s-10>80)?hsv.s-10:hsv.s+10,s3=(hsv.s-25>10)?hsv.s-25:hsv.s+25,v1=(hsv.v-40>10)?hsv.v-40:hsv.v+40,v2=(hsv.v-20>80)?hsv.v-20:hsv.v+20,v3=Math.max(hsv.v,20);return new _2.Palette([dojox.color.fromHsv(h1,s1,v1),dojox.color.fromHsv(h1,s2,v2),_2a,dojox.color.fromHsv(h2,s3,v3),dojox.color.fromHsv(h3,s2,v2)]);},shades:function(_2b){var _2c=_1.isString(_2b.base)?new dojox.color.Color(_2b.base):_2b.base,hsv=_2c.toHsv();var s=(hsv.s==100&&hsv.v==0)?0:hsv.s,v1=(hsv.v-50>20)?hsv.v-50:hsv.v+30,v2=(hsv.v-25>=20)?hsv.v-25:hsv.v+55,v3=(hsv.v-75>=20)?hsv.v-75:hsv.v+5,v4=Math.max(hsv.v-10,20);return new _2.Palette([new dojox.color.fromHsv(hsv.h,s,v1),new dojox.color.fromHsv(hsv.h,s,v2),_2c,new dojox.color.fromHsv(hsv.h,s,v3),new dojox.color.fromHsv(hsv.h,s,v4)]);}},generate:function(_2d,_2e){if(_1.isFunction(_2e)){return _2e({base:_2d});}else{if(_2.Palette.generators[_2e]){return _2.Palette.generators[_2e]({base:_2d});}}throw new Error("dojox.color.Palette.generate: the specified generator ('"+_2e+"') does not exist.");}});return _2.Palette;});