/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

dojo.addOnLoad(init);var tabContainer,gridContainer;function init(){tabContainer=dijit.byId("tb1");dojo.subscribe("/dnd/drop/after","createNode");var _1=dojox.mdnd.adapter.dndToDojo();var _2=dojo.query(".dijitTab",tabContainer.tablist.containerNode).forEach(function(_3){_1.register(_3,tabContainer.declaredClass);});_1.register(c2.node,"targetDojo",true,"Drag Me !");_1.isAccepted=function(_4,_5){var _6=dijit.byNode(_4).get("dndType");switch(_5.type){case "dijit.layout.TabContainer":var _7=dijit.byNode(_5.node);var _8=tabContainer.getChildren();for(var i=0,l=_8.length;i<l;i++){var gc=_8[i];if(gc.controlButton==_7){for(var j=0;j<gc.acceptTypes.length;j++){if(_6==gc.acceptTypes[j]){gridContainer=gc;return true;}}if(j==gc.acceptTypes.length){return false;}}}break;default:return true;break;}};dojo.subscribe("/dojox/mdnd/adapter/dndToDojo/over",null,"onOver");dojo.subscribe("/dojox/mdnd/adapter/dndToDojo/out",null,"onOut");dojo.subscribe("/dojox/mdnd/adapter/dndToDojo/drop",null,"onDrop");dojo.subscribe("/dojox/mdnd/drop",null,function(){dojo.forEach(_2,function(_9){dojo.removeClass(_9,"dndOver");dojo.removeClass(_9,"dndOverNotAccepted");});});dojo.subscribe(tabContainer.domNode.id+"-removeChild",null,"refresh");};function createNode(_a,_b,_c,_d,_e){if(_d){var _f=_createWidget(_b);dojox.mdnd.areaManager().addDragItem(_d,_f.domNode,_e);}};function _createWidget(_10){var _11=_10[0].getAttribute("dndType");var _12;switch(_11){case "ContentPane":_12=new dijit.layout.ContentPane();dojo.addClass(_12.domNode,"cpane");_12.set("dndType","ContentPane");break;case "Portlet":_12=new dojox.widget.Portlet({title:"portlet",closable:true,dndType:"Portlet"});break;case "TitlePane":_12=new dijit.TitlePane({title:"TitlePane",dndType:"TitlePane"});break;default:_12=new dijit.layout.ContentPane();dojo.addClass(_12.domNode,"cpane");_12.set("dndType","ContentPane");break;}_12.set("content","Lorem ipsum dolor sit amet, consectetuer adipiscing elit.");_12.startup();return _12;};function onOver(_13,_14,_15,_16){switch(_14){case "dijit.layout.TabContainer":if(_16){dojo.addClass(_13,"dndOver");}else{dojo.addClass(_13,"dndOverNotAccepted");}break;}};function onOut(_17,_18,_19,_1a){switch(_18){case "dijit.layout.TabContainer":dojo.removeClass(_17,"dndOver");dojo.removeClass(_17,"dndOverNotAccepted");break;}};function onDrop(_1b,_1c,_1d){switch(_1d){case "dijit.layout.TabContainer":gridContainer.addChild(dijit.byNode(_1b),0,0);dojo.removeClass(_1c,"dndOver");dojo.removeClass(_1c,"dndOverNotAccepted");break;}};function refresh(){dojox.mdnd.adapter.dndToDojo().refresh();};