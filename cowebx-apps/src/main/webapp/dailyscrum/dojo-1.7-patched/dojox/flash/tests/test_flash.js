/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo","dijit","dojox","dojox/flash"],function(_1,_2,_3){_1.getObject("dojox.flash.tests.test_flash",1);var _4=false;var _5=false;var _6=testBook=null;function _7(){if(_4){return;}_4=true;if(_8()){_9();}};function _a(){if(_5){return;}_5=true;_b();if(_8()){_9();}};function _8(){return _6&&testBook&&_5&&_4;};function _b(){var d=_1.xhrGet({url:"../../storage/tests/resources/testXML.xml",handleAs:"text"});d.addCallback(function(_c){_6=_c;if(_8()){_9();}});d.addErrback(function(_d){});d=_1.xhrGet({url:"../../storage/tests/resources/testBook.txt",handleAs:"text"});d.addCallback(function(_e){testBook=_e;if(_8()){_9();}});d.addErrback(function(_f){});};function _9(){try{var _10,_11;_10="hello world";_3.flash.comm.setMessage(_10);_11=_3.flash.comm.getMessage();_12(_10,_11,"Setting/getting simple message did not work");_13(_10);var _14="\\";_14=_14.charAt(0);_10="hello world\n\n\nasdfasdf!@#$@#%^[]{}&amp;<xml>"+_14+"<div>$%^&%^&*^&()<><><>,./;\x00\r\f'][`~=\"+-]\\0MORE!\n\rLESS";var _15=_3.flash.comm.setMessage(_10);_12(_15,_10.length,"Failed putting. Correct length = "+_10.length+", Flash length = "+_15);_3.flash.comm.setMessage(_10);_11=_3.flash.comm.getMessage();_12(_10,_11,"Setting/getting message with evil characters did not work");_13(_10);_10=_6;_3.flash.comm.setMessage(_10);_11=_3.flash.comm.getMessage();_12(_10,_11,"Setting/getting testXML did not work");_13(_10);_10=testBook;_3.flash.comm.setMessage(_10);_11=_3.flash.comm.getMessage();_12(_10,_11,"Setting/getting testBook did not work");_10=testBook+testBook+testBook;_3.flash.comm.setMessage(_10);_11=_3.flash.comm.getMessage();_12(_10,_11,"Setting/getting testBook X 3 did not work");var obj={type:"car",color:"red",model:"Ford",year:"2008",features:["A/C","automatic","4-wheel drive"]};_10=_1.toJson(obj,true);_3.flash.comm.setMessage(_10);_11=_3.flash.comm.getMessage();_12(_10,_11,"Setting/getting JSON did not work");_13(_10);_11=_3.flash.comm.multipleValues("key","value","namespace");_12("namespacekeyvalue",_11,"Setting/getting multiple values did not work");var _16=document.createElement("p");_16.style.backgroundColor="green";_16.style.color="white";_16.style.fontSize="24pt";_16.appendChild(document.createTextNode("All tests passed"));var _17=document.getElementsByTagName("body")[0];_17.appendChild(_16);}catch(e){}};function _13(_18){for(var i=0;i<Math.min(_18.length,100);i++){_19(_18,0,i+1);}};function _19(_1a,_1b,to){var _1c=_3.flash.comm.setMessageSlice(_1a,_1b,to);var _1d=_3.flash.comm.getMessage();var _1e=_1a.slice(_1b,to);var msg="Put a string with "+_1a.length+" chars, but it got with "+_1c+" chars in the Flash layer";_12(_1c,_1a.length,msg);msg="I got '"+_1d+"' instead of '"+_1e+"'";_12(_1e,_1d,msg);};function _12(_1f,_20,msg){if(_1f!=_20){var _21=document.createElement("p");_21.style.backgroundColor="red";_21.style.color="white";_21.style.fontSize="24pt";_21.appendChild(document.createTextNode("Test failed: "+msg));var _22=document.getElementsByTagName("body")[0];_22.appendChild(_21);throw new Error("ASSERTION FAILED: "+msg);}else{}};undefined;_3.flash.addLoadedListener(_7);_3.flash.setSwf("TestFlash.swf",false);_1.connect(_1,"loaded",_a);});require(["dojox/flash/tests/test_flash"]);