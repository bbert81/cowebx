/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo","dijit","dojox","dojox/data/AndOrReadStore","dojo/data/api/Read","dojo/data/api/Identity","dojo/date","dojo/date/stamp"],function(_1,_2,_3){_1.getObject("dojox.data.tests.stores.AndOrReadStore",1);_1.declare("dojox.data.tests.Wrapper",null,{_wrapped:null,constructor:function(_4){this._wrapped=_4;},getValue:function(){return this._wrapped;},setValue:function(_5){this._wrapped=_5;},toString:function(){return "WRAPPER: ["+this._wrapped+"]";}});_3.data.tests.stores.AndOrReadStore.getTestData=function(_6){var _7=null;if(_6==="countries"){if(_1.isBrowser){_7={url:_1.moduleUrl("dojox","data/tests/stores/countries.json").toString()};}else{_7={data:{identifier:"abbr",label:"name",items:[{abbr:"ec",name:"Ecuador",capital:"Quito"},{abbr:"eg",name:"Egypt",capital:"Cairo"},{abbr:"sv",name:"El Salvador",capital:"San Salvador"},{abbr:"gq",name:"Equatorial Guinea",capital:"Malabo"},{abbr:"er",name:"Eritrea",capital:"Asmara"},{abbr:"ee",name:"Estonia",capital:"Tallinn"},{abbr:"et",name:"Ethiopia",capital:"Addis Ababa"}]}};}}else{if(_6==="countries_withNull"){_7={data:{identifier:"abbr",items:[{abbr:"ec",name:null,capital:"Quito"},{abbr:"eg",name:null,capital:"Cairo"},{abbr:"sv",name:"El Salvador",capital:"San Salvador"},{abbr:"gq",name:"Equatorial Guinea",capital:"Malabo"},{abbr:"er",name:"Eritrea",capital:"Asmara"},{abbr:"ee",name:null,capital:"Tallinn"},{abbr:"et",name:"Ethiopia",capital:"Addis Ababa"}]}};}else{if(_6==="countries_withoutid"){_7={data:{label:"name",items:[{abbr:"ec",name:null,capital:"Quito"},{abbr:"eg",name:null,capital:"Cairo"},{abbr:"sv",name:"El Salvador",capital:"San Salvador"},{abbr:"gq",name:"Equatorial Guinea",capital:"Malabo"},{abbr:"er",name:"Eritrea",capital:"Asmara"},{abbr:"ee",name:null,capital:"Tallinn"},{abbr:"et",name:"Ethiopia",capital:"Addis Ababa"}]}};}else{if(_6==="countries_withBoolean"){_7={data:{identifier:"abbr",items:[{abbr:"ec",name:"Ecuador",capital:"Quito",real:true},{abbr:"eg",name:"Egypt",capital:"Cairo",real:true},{abbr:"sv",name:"El Salvador",capital:"San Salvador",real:true},{abbr:"gq",name:"Equatorial Guinea",capital:"Malabo",real:true},{abbr:"er",name:"Eritrea",capital:"Asmara",real:true},{abbr:"ee",name:"Estonia",capital:"Tallinn",real:true},{abbr:"et",name:"Ethiopia",capital:"Addis Ababa",real:true},{abbr:"ut",name:"Utopia",capital:"Paradise",real:false}]}};}else{if(_6==="countries_withDates"){_7={data:{identifier:"abbr",items:[{abbr:"ec",name:"Ecuador",capital:"Quito"},{abbr:"eg",name:"Egypt",capital:"Cairo"},{abbr:"sv",name:"El Salvador",capital:"San Salvador"},{abbr:"gq",name:"Equatorial Guinea",capital:"Malabo"},{abbr:"er",name:"Eritrea",capital:"Asmara",independence:{_type:"Date",_value:"1993-05-24T00:00:00Z"}},{abbr:"ee",name:"Estonia",capital:"Tallinn",independence:{_type:"Date",_value:"1991-08-20T00:00:00Z"}},{abbr:"et",name:"Ethiopia",capital:"Addis Ababa"}]}};}else{if(_6==="geography_hierarchy_small"){_7={data:{items:[{name:"Africa",countries:[{name:"Egypt",capital:"Cairo"},{name:"Kenya",capital:"Nairobi"},{name:"Sudan",capital:"Khartoum"}]},{name:"Australia",capital:"Canberra"},{name:"North America",countries:[{name:"Canada",population:"33 million",cities:[{name:"Toronto",population:"2.5 million"},{name:"Alberta",population:"1 million"}]},{name:"United States of America",capital:"Washington DC",states:[{name:"Missouri"},{name:"Arkansas"}]}]}]}};}else{if(_6==="data_multitype"){_7={data:{"identifier":"count","label":"count",items:[{count:1,value:"true"},{count:2,value:true},{count:3,value:"false"},{count:4,value:false},{count:5,value:true},{count:6,value:true},{count:7,value:"true"},{count:8,value:"true"},{count:9,value:"false"},{count:10,value:false},{count:11,value:[false,false]},{count:"12",value:[false,"true"]}]}};}else{if(_6==="countries_references"){_7={data:{identifier:"name",label:"name",items:[{name:"Africa",type:"continent",children:[{_reference:"Egypt"},{_reference:"Kenya"},{_reference:"Sudan"}]},{name:"Egypt",type:"country"},{name:"Kenya",type:"country",children:[{_reference:"Nairobi"},{_reference:"Mombasa"}]},{name:"Nairobi",type:"city"},{name:"Mombasa",type:"city"},{name:"Sudan",type:"country",children:{_reference:"Khartoum"}},{name:"Khartoum",type:"city"},{name:"Asia",type:"continent",children:[{_reference:"China"},{_reference:"India"},{_reference:"Russia"},{_reference:"Mongolia"}]},{name:"China",type:"country"},{name:"India",type:"country"},{name:"Russia",type:"country"},{name:"Mongolia",type:"country"},{name:"Australia",type:"continent",population:"21 million",children:{_reference:"Commonwealth of Australia"}},{name:"Commonwealth of Australia",type:"country",population:"21 million"},{name:"Europe",type:"continent",children:[{_reference:"Germany"},{_reference:"France"},{_reference:"Spain"},{_reference:"Italy"}]},{name:"Germany",type:"country"},{name:"France",type:"country"},{name:"Spain",type:"country"},{name:"Italy",type:"country"},{name:"North America",type:"continent",children:[{_reference:"Mexico"},{_reference:"Canada"},{_reference:"United States of America"}]},{name:"Mexico",type:"country",population:"108 million",area:"1,972,550 sq km",children:[{_reference:"Mexico City"},{_reference:"Guadalajara"}]},{name:"Mexico City",type:"city",population:"19 million",timezone:"-6 UTC"},{name:"Guadalajara",type:"city",population:"4 million",timezone:"-6 UTC"},{name:"Canada",type:"country",population:"33 million",area:"9,984,670 sq km",children:[{_reference:"Ottawa"},{_reference:"Toronto"}]},{name:"Ottawa",type:"city",population:"0.9 million",timezone:"-5 UTC"},{name:"Toronto",type:"city",population:"2.5 million",timezone:"-5 UTC"},{name:"United States of America",type:"country"},{name:"South America",type:"continent",children:[{_reference:"Brazil"},{_reference:"Argentina"}]},{name:"Brazil",type:"country",population:"186 million"},{name:"Argentina",type:"country",population:"40 million"}]}};}}}}}}}}return _7;};_3.data.tests.stores.AndOrReadStore.getTests=function(){_3.data.tests.stores.AndOrReadStore.tests=[{name:"Identity API: fetchItemByIdentity()",runTest:function(t){var _8=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _9=function(_a){t.assertTrue(_a!==null);if(_a!==null){var _b=_8.getValue(_a,"name");t.assertEqual(_b,"El Salvador");}d.callback(true);};var _c=function(_d){t.assertTrue(false);d.errback(_d);};_8.fetchItemByIdentity({identity:"sv",onItem:_9,onError:_c});return d;}},{name:"Identity API: fetchItemByIdentity() notFound",runTest:function(t){var _e=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _f=function(_10){t.assertTrue(_10===null);d.callback(true);};var _11=function(_12){t.assertTrue(false);d.errback(_12);};_e.fetchItemByIdentity({identity:"sv_not",onItem:_f,onError:_11});return d;}},{name:"Identity API: getIdentityAttributes()",runTest:function(t){var _13=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _14=function(_15){t.assertTrue(_15!==null);var _16=_13.getIdentityAttributes(_15);t.assertTrue(_1.isArray(_16));t.assertEqual(1,_16.length);t.assertEqual("abbr",_16[0]);d.callback(true);};var _17=function(_18){t.assertTrue(false);d.errback(_18);};_13.fetchItemByIdentity({identity:"sv",onItem:_14,onError:_17});return d;}},{name:"Identity API: fetchItemByIdentity() commentFilteredJson",runTest:function(t){if(_1.isBrowser){var _19=new _3.data.AndOrReadStore({url:_1.moduleUrl("tests","data/countries_commentFiltered.json").toString()});var d=new doh.Deferred();var _1a=function(_1b){t.assertTrue(_1b!==null);var _1c=_19.getValue(_1b,"name");t.assertEqual(_1c,"El Salvador");d.callback(true);};var _1d=function(_1e){t.assertTrue(false);d.errback(_1e);};_19.fetchItemByIdentity({identity:"sv",onItem:_1a,onError:_1d});return d;}}},{name:"Identity API: fetchItemByIdentity() nullValue",runTest:function(t){var _1f=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries_withNull"));var d=new doh.Deferred();var _20=function(_21){t.assertTrue(_21!==null);var _22=_1f.getValue(_21,"name");t.assertEqual(_22,null);d.callback(true);};var _23=function(_24){t.assertTrue(false);d.errback(_24);};_1f.fetchItemByIdentity({identity:"ec",onItem:_20,onError:_23});return d;}},{name:"Identity API: fetchItemByIdentity() booleanValue",runTest:function(t){var _25=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries_withBoolean"));var d=new doh.Deferred();var _26=function(_27){t.assertTrue(_27!==null);var _28=_25.getValue(_27,"name");t.assertEqual(_28,"Utopia");var _29=_25.getValue(_27,"real");t.assertEqual(_29,false);d.callback(true);};var _2a=function(_2b){t.assertTrue(false);d.errback(_2b);};_25.fetchItemByIdentity({identity:"ut",onItem:_26,onError:_2a});return d;}},{name:"Identity API: fetchItemByIdentity() withoutSpecifiedIdInData",runTest:function(t){var _2c=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries_withoutid"));var d=new doh.Deferred();var _2d=function(_2e){t.assertTrue(_2e!==null);var _2f=_2c.getValue(_2e,"name");t.assertEqual(_2f,"El Salvador");d.callback(true);};var _30=function(_31){t.assertTrue(false);d.errback(_31);};_2c.fetchItemByIdentity({identity:"2",onItem:_2d,onError:_30});return d;}},{name:"Identity API: getIdentity()",runTest:function(t){var _32=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _33=function(_34){t.assertTrue(_34!==null);t.assertTrue(_32.getIdentity(_34)==="sv");d.callback(true);};var _35=function(_36){t.assertTrue(false);d.errback(_36);};_32.fetchItemByIdentity({identity:"sv",onItem:_33,onError:_35});return d;}},{name:"Identity API: getIdentity() withoutSpecifiedId",runTest:function(t){var _37=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries_withoutid"));var d=new doh.Deferred();var _38=function(_39,_3a){t.assertTrue(_39!==null);t.assertTrue(_37.getIdentity(_39)===2);d.callback(true);};var _3b=function(_3c,_3d){t.assertTrue(false);d.errback(_3c);};_37.fetch({query:{abbr:"sv"},onItem:_38,onError:_3b});return d;}},{name:"Identity API: getIdentity() withoutSpecifiedId, complex",runTest:function(t){var _3e=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries_withoutid"));var d=new doh.Deferred();var _3f=function(_40,_41){t.assertTrue(_40!==null);t.assertTrue(_3e.getIdentity(_40)===2);d.callback(true);};var _42=function(_43,_44){t.assertTrue(false);d.errback(_43);};_3e.fetch({query:"abbr: \"sv\"",onItem:_3f,onError:_42});return d;}},{name:"Read API: fetch() all",runTest:function(t){var _45=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _46=function(_47,_48){t.is(7,_47.length);d.callback(true);};var _49=function(_4a,_4b){t.assertTrue(false);d.errback(_4a);};_45.fetch({onComplete:_46,onError:_49});return d;}},{name:"Read API: fetch() abort",runTest:function(t){if(_1.isBrowser){var _4c=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _4d=false;function _4e(_4f,_50){t.is(7,_4f.length);if(_4d){d.errback(new Error("Should not be here."));}else{d.callback(true);}};function _51(_52,_53){t.assertTrue(true);d.callback(true);};var req=_4c.fetch({onComplete:_4e,onError:_51});_4d=true;req.abort();return d;}}},{name:"Read API: fetch() one",runTest:function(t){var _54=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _55=function(_56,_57){t.assertEqual(_56.length,1);d.callback(true);};var _58=function(_59,_5a){t.assertTrue(false);d.errback(_59);};_54.fetch({query:{abbr:"ec"},onComplete:_55,onError:_58});return d;}},{name:"Read API: fetch() one, complex",runTest:function(t){var _5b=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _5c=function(_5d,_5e){t.assertEqual(_5d.length,1);d.callback(true);};var _5f=function(_60,_61){t.assertTrue(false);d.errback(_60);};_5b.fetch({query:"abbr: \"ec\"",onComplete:_5c,onError:_5f});return d;}},{name:"Read API: fetch() shallow",runTest:function(t){var _62=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("geography_hierarchy_small"));var d=new doh.Deferred();var _63=function(_64,_65){t.assertEqual(_64.length,2);d.callback(true);};var _66=function(_67,_68){t.assertTrue(false);d.errback(_67);};_62.fetch({query:{name:"A*"},onComplete:_63,onError:_66});return d;}},{name:"Read API: fetch() shallow, complex",runTest:function(t){var _69=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("geography_hierarchy_small"));var d=new doh.Deferred();var _6a=function(_6b,_6c){t.assertEqual(_6b.length,2);d.callback(true);};var _6d=function(_6e,_6f){t.assertTrue(false);d.errback(_6e);};_69.fetch({query:"name: \"A*\"",onComplete:_6a,onError:_6d});return d;}},{name:"Read API: fetch() Multiple",runTest:function(t){var _70=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("geography_hierarchy_small"));var d=new doh.Deferred();var _71=[false,false];var _72=function(_73,_74){_71[0]=true;t.assertEqual(_73.length,2);if(_71[0]&&_71[1]){d.callback(true);}};var _75=function(_76,_77){_71[1]=true;if(_71[0]&&_71[1]){d.callback(true);}};var _78=function(_79,_7a){t.assertTrue(false);d.errback(_79);};_70.fetch({query:{name:"A*"},onComplete:_72,onError:_78});_70.fetch({query:{name:"N*"},onComplete:_75,onError:_78});return d;}},{name:"Read API: fetch() Multiple, complex",runTest:function(t){var _7b=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("geography_hierarchy_small"));var d=new doh.Deferred();var _7c=[false,false];var _7d=function(_7e,_7f){_7c[0]=true;t.assertEqual(_7e.length,2);if(_7c[0]&&_7c[1]){d.callback(true);}};var _80=function(_81,_82){_7c[1]=true;if(_7c[0]&&_7c[1]){d.callback(true);}};var _83=function(_84,_85){t.assertTrue(false);d.errback(_84);};_7b.fetch({query:"name: \"A*\"",onComplete:_7d,onError:_83});_7b.fetch({query:"name: \"N*\"",onComplete:_80,onError:_83});return d;}},{name:"Read API: fetch() MultipleMixedFetch",runTest:function(t){var _86=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _87=[false,false];var _88=function(_89,_8a){_87[0]=true;t.assertEqual(_89.length,1);if(_87[0]&&_87[1]){d.callback(true);}};var _8b=function(_8c){_87[1]=true;t.assertTrue(_8c!==null);var _8d=_86.getValue(_8c,"name");t.assertEqual(_8d,"El Salvador");if(_87[0]&&_87[1]){d.callback(true);}};var _8e=function(_8f){t.assertTrue(false);d.errback(_8f);};_86.fetch({query:{name:"El*"},onComplete:_88,onError:_8e});_86.fetchItemByIdentity({identity:"sv",onItem:_8b,onError:_8e});return d;}},{name:"Read API: fetch() MultipleMixedFetch, complex",runTest:function(t){var _90=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _91=[false,false];var _92=function(_93,_94){_91[0]=true;t.assertEqual(_93.length,1);if(_91[0]&&_91[1]){d.callback(true);}};var _95=function(_96){_91[1]=true;t.assertTrue(_96!==null);var _97=_90.getValue(_96,"name");t.assertEqual(_97,"El Salvador");if(_91[0]&&_91[1]){d.callback(true);}};var _98=function(_99){t.assertTrue(false);d.errback(_99);};_90.fetch({query:"name: \"El*\"",onComplete:_92,onError:_98});_90.fetchItemByIdentity({identity:"sv",onItem:_95,onError:_98});return d;}},{name:"Read API: fetch() deep",runTest:function(t){var _9a=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("geography_hierarchy_small"));var d=new doh.Deferred();var _9b=function(_9c,_9d){t.assertEqual(_9c.length,4);d.callback(true);};var _9e=function(_9f,_a0){t.assertTrue(false);d.errback(_9f);};_9a.fetch({query:{name:"A*"},onComplete:_9b,onError:_9e,queryOptions:{deep:true}});return d;}},{name:"Read API: fetch() deep, complex",runTest:function(t){var _a1=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("geography_hierarchy_small"));var d=new doh.Deferred();var _a2=function(_a3,_a4){t.assertEqual(_a3.length,4);d.callback(true);};var _a5=function(_a6,_a7){t.assertTrue(false);d.errback(_a6);};_a1.fetch({query:"name: \"A*\"",onComplete:_a2,onError:_a5,queryOptions:{deep:true}});return d;}},{name:"Read API: fetch() hierarchy off",runTest:function(t){var _a8=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("geography_hierarchy_small"));_a8.hierarchical=false;var d=new doh.Deferred();function _a9(_aa,_ab){t.assertEqual(2,_aa.length);var i;var _ac=true;for(i=0;i<_aa.length;i++){var _ad=_a8.getValues(_aa[i],"countries");if(_ad){var j;for(j=0;j<_ad.length;j++){_ac=!_a8.isItem(_ad[j]);if(!_ac){break;}}}if(!_ac){break;}}if(!_ac){d.errback(new Error("Located a child item with hierarchy off and no references in the data.  Error."));}else{d.callback(true);}};function _ae(_af,_b0){d.errback(_af);};_a8.fetch({query:{name:"A*"},onComplete:_a9,onError:_ae,queryOptions:{deep:true}});return d;}},{name:"Read API: fetch() hierarchy off refs still parse",runTest:function(t){var _b1=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries_references"));_b1.hierarchical=false;var d=new doh.Deferred();function _b2(_b3,_b4){t.assertEqual(_b3.length,4);var i;var _b5=true;for(i=0;i<_b3.length;i++){var _b6=_b1.getValues(_b3[i],"children");if(_b6){var j;for(j=0;j<_b6.length;j++){_b5=_b1.isItem(_b6[j]);if(!_b5){break;}}}if(!_b5){break;}}if(!_b5){d.errback(new Error("Found a non-child item in a reference list in a references based input.  Error."));}else{d.callback(true);}};function _b7(_b8,_b9){t.assertTrue(false);d.errback(_b8);};_b1.fetch({query:{name:"A*"},onComplete:_b2,onError:_b7,queryOptions:{deep:true}});return d;}},{name:"Read API: fetch() one_commentFilteredJson",runTest:function(t){if(_1.isBrowser){var _ba=new _3.data.AndOrReadStore({url:_1.moduleUrl("tests","data/countries_commentFiltered.json").toString()});var d=new doh.Deferred();var _bb=function(_bc,_bd){t.assertEqual(_bc.length,1);d.callback(true);};var _be=function(_bf,_c0){t.assertTrue(false);d.errback(_bf);};_ba.fetch({query:{abbr:"ec"},onComplete:_bb,onError:_be});return d;}}},{name:"Read API: fetch() one_commentFilteredJson, complex",runTest:function(t){if(_1.isBrowser){var _c1=new _3.data.AndOrReadStore({url:_1.moduleUrl("tests","data/countries_commentFiltered.json").toString()});var d=new doh.Deferred();var _c2=function(_c3,_c4){t.assertEqual(_c3.length,1);d.callback(true);};var _c5=function(_c6,_c7){t.assertTrue(false);d.errback(_c6);};_c1.fetch({query:"abbr: \"ec\"",onComplete:_c2,onError:_c5});return d;}}},{name:"Read API: fetch() withNull",runTest:function(t){var _c8=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries_withNull"));var d=new doh.Deferred();var _c9=function(_ca,_cb){t.assertEqual(4,_ca.length);d.callback(true);};var _cc=function(_cd,_ce){t.assertTrue(false);d.errback(_cd);};_c8.fetch({query:{name:"E*"},onComplete:_c9,onError:_cc});return d;}},{name:"Read API: fetch() withNull, complex",runTest:function(t){var _cf=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries_withNull"));var d=new doh.Deferred();var _d0=function(_d1,_d2){t.assertEqual(4,_d1.length);d.callback(true);};var _d3=function(_d4,_d5){t.assertTrue(false);d.errback(_d4);};_cf.fetch({query:"name: \"E*\"",onComplete:_d0,onError:_d3});return d;}},{name:"Read API: fetch() all_streaming",runTest:function(t){var _d6=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _d7=0;var _d8=function(_d9,_da){t.assertEqual(_d9,7);};var _db=function(_dc,_dd){t.assertTrue(_d6.isItem(_dc));_d7++;};var _de=function(_df,_e0){t.assertEqual(_d7,7);t.assertTrue(_df===null);d.callback(true);};var _e1=function(_e2,_e3){t.assertTrue(false);d.errback(_e2);};_d6.fetch({onBegin:_d8,onItem:_db,onComplete:_de,onError:_e1});return d;}},{name:"Read API: fetch() paging",runTest:function(t){var _e4=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _e5=function(_e6,_e7){t.assertEqual(_e6.length,5);d.callback(true);};var _e8=function(_e9,_ea){t.assertEqual(_e9.length,0);_ea.start=2;_ea.count=20;_ea.onComplete=_e5;_e4.fetch(_ea);};var _eb=function(_ec,_ed){t.assertEqual(_ec.length,5);_ed.start=9;_ed.count=100;_ed.onComplete=_e8;_e4.fetch(_ed);};var _ee=function(_ef,_f0){t.assertEqual(_ef.length,5);_f0.start=2;_f0.count=20;_f0.onComplete=_eb;_e4.fetch(_f0);};var _f1=function(_f2,_f3){t.assertEqual(_f2.length,1);_f3.start=0;_f3.count=5;_f3.onComplete=_ee;_e4.fetch(_f3);};var _f4=function(_f5,_f6){t.assertEqual(_f5.length,5);_f6.start=3;_f6.count=1;_f6.onComplete=_f1;_e4.fetch(_f6);};var _f7=function(_f8,_f9){t.assertEqual(_f8.length,7);_f9.start=1;_f9.count=5;_f9.onComplete=_f4;_e4.fetch(_f9);};var _fa=function(_fb,_fc){t.assertTrue(false);d.errback(_fb);};_e4.fetch({onComplete:_f7,onError:_fa});return d;}},{name:"Read API: fetch() with MultiType Match",runTest:function(t){var _fd=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("data_multitype"));var d=new doh.Deferred();var _fe=function(_ff,_100){t.assertEqual(4,_ff.length);d.callback(true);};var _101=function(_102,_103){t.assertTrue(false);d.errback(_102);};_fd.fetch({query:{count:"1*"},onComplete:_fe,onError:_101});return d;}},{name:"Read API: fetch() with MultiType Match, complex",runTest:function(t){var _104=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("data_multitype"));var d=new doh.Deferred();var _105=function(_106,_107){t.assertEqual(4,_106.length);d.callback(true);};var _108=function(_109,_10a){t.assertTrue(false);d.errback(_109);};_104.fetch({query:"count: \"1*\"",onComplete:_105,onError:_108});return d;}},{name:"Read API: fetch() with MultiType, MultiValue Match",runTest:function(t){var _10b=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("data_multitype"));var d=new doh.Deferred();var _10c=function(_10d,_10e){t.assertEqual(7,_10d.length);d.callback(true);};var _10f=function(_110,_111){t.assertTrue(false);d.errback(_110);};_10b.fetch({query:{value:"true"},onComplete:_10c,onError:_10f});return d;}},{name:"Read API: fetch() with MultiType, MultiValue Match, complex",runTest:function(t){var _112=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("data_multitype"));var d=new doh.Deferred();var _113=function(_114,_115){t.assertEqual(7,_114.length);d.callback(true);};var _116=function(_117,_118){t.assertTrue(false);d.errback(_117);};_112.fetch({query:"value: \"true\"",onComplete:_113,onError:_116});return d;}},{name:"Read API: getLabel()",runTest:function(t){var _119=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _11a=function(_11b,_11c){t.assertEqual(_11b.length,1);var _11d=_119.getLabel(_11b[0]);t.assertTrue(_11d!==null);t.assertEqual("Ecuador",_11d);d.callback(true);};var _11e=function(_11f,_120){t.assertTrue(false);d.errback(_11f);};_119.fetch({query:{abbr:"ec"},onComplete:_11a,onError:_11e});return d;}},{name:"Read API: getLabel(), complex",runTest:function(t){var _121=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _122=function(_123,_124){t.assertEqual(_123.length,1);var _125=_121.getLabel(_123[0]);t.assertTrue(_125!==null);t.assertEqual("Ecuador",_125);d.callback(true);};var _126=function(_127,_128){t.assertTrue(false);d.errback(_127);};_121.fetch({query:"abbr: \"ec\"",onComplete:_122,onError:_126});return d;}},{name:"Read API: getLabelAttributes()",runTest:function(t){var _129=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _12a=function(_12b,_12c){t.assertEqual(_12b.length,1);var _12d=_129.getLabelAttributes(_12b[0]);t.assertTrue(_1.isArray(_12d));t.assertEqual("name",_12d[0]);d.callback(true);};var _12e=function(_12f,_130){t.assertTrue(false);d.errback(_12f);};_129.fetch({query:{abbr:"ec"},onComplete:_12a,onError:_12e});return d;}},{name:"Read API: getLabelAttributes(), complex",runTest:function(t){var _131=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _132=function(_133,_134){t.assertEqual(_133.length,1);var _135=_131.getLabelAttributes(_133[0]);t.assertTrue(_1.isArray(_135));t.assertEqual("name",_135[0]);d.callback(true);};var _136=function(_137,_138){t.assertTrue(false);d.errback(_137);};_131.fetch({query:"abbr: \"ec\"",onComplete:_132,onError:_136});return d;}},{name:"Read API: getValue()",runTest:function(t){var _139=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _13a=function(item){t.assertTrue(item!==null);var name=_139.getValue(item,"name");t.assertTrue(name==="El Salvador");d.callback(true);};var _13b=function(_13c){t.assertTrue(false);d.errback(_13c);};_139.fetchItemByIdentity({identity:"sv",onItem:_13a,onError:_13b});return d;}},{name:"Read API: getValues()",runTest:function(t){var _13d=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _13e=function(item){t.assertTrue(item!==null);var _13f=_13d.getValues(item,"name");t.assertTrue(_1.isArray(_13f));t.assertEqual(_13f.length,1);t.assertEqual(_13f[0],"El Salvador");d.callback(true);};var _140=function(_141){t.assertTrue(false);d.errback(_141);};_13d.fetchItemByIdentity({identity:"sv",onItem:_13e,onError:_140});return d;}},{name:"Read API: isItem()",runTest:function(t){var _142=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _143=function(item){t.assertTrue(item!==null);t.assertTrue(_142.isItem(item));t.assertTrue(!_142.isItem({}));d.callback(true);};var _144=function(_145){t.assertTrue(false);d.errback(_145);};_142.fetchItemByIdentity({identity:"sv",onItem:_143,onError:_144});return d;}},{name:"Read API: isItem() multistore",runTest:function(t){var _146=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var _147=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _148=function(_149){t.assertTrue(false);d.errback(_149);};var _14a=function(_14b){t.assertTrue(_14b!==null);var _14c=function(_14d){t.assertTrue(_14b!==null);t.assertTrue(_14d!==null);t.assertTrue(_146.isItem(_14b));t.assertTrue(_147.isItem(_14d));t.assertTrue(!_146.isItem(_14d));t.assertTrue(!_147.isItem(_14b));d.callback(true);};_147.fetchItemByIdentity({identity:"sv",onItem:_14c,onError:_148});};_146.fetchItemByIdentity({identity:"sv",onItem:_14a,onError:_148});return d;}},{name:"Read API: hasAttribute()",runTest:function(t){var _14e=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _14f=function(item){t.assertTrue(item!==null);t.assertTrue(_14e.hasAttribute(item,"abbr"));t.assertTrue(!_14e.hasAttribute(item,"abbr_not"));var _150=false;try{_14e.hasAttribute(item,null);}catch(e){_150=true;}t.assertTrue(_150);d.callback(true);};var _151=function(_152){t.assertTrue(false);d.errback(_152);};_14e.fetchItemByIdentity({identity:"sv",onItem:_14f,onError:_151});return d;}},{name:"Read API: containsValue()",runTest:function(t){var _153=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _154=function(item){t.assertTrue(item!==null);t.assertTrue(_153.containsValue(item,"abbr","sv"));t.assertTrue(!_153.containsValue(item,"abbr","sv1"));t.assertTrue(!_153.containsValue(item,"abbr",null));var _155=false;try{_153.containsValue(item,null,"foo");}catch(e){_155=true;}t.assertTrue(_155);d.callback(true);};var _156=function(_157){t.assertTrue(false);d.errback(_157);};_153.fetchItemByIdentity({identity:"sv",onItem:_154,onError:_156});return d;}},{name:"Read API: getAttributes()",runTest:function(t){var _158=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _159=function(item){t.assertTrue(item!==null);t.assertTrue(_158.isItem(item));var _15a=_158.getAttributes(item);t.assertEqual(_15a.length,3);for(var i=0;i<_15a.length;i++){t.assertTrue((_15a[i]==="name"||_15a[i]==="abbr"||_15a[i]==="capital"));}d.callback(true);};var _15b=function(_15c){t.assertTrue(false);d.errback(_15c);};_158.fetchItemByIdentity({identity:"sv",onItem:_159,onError:_15b});return d;}},{name:"Read API: getFeatures()",runTest:function(t){var _15d=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var _15e=_15d.getFeatures();t.assertTrue(_15e["dojo.data.api.Read"]!==null);t.assertTrue(_15e["dojo.data.api.Identity"]!==null);}},{name:"Read API: fetch() patternMatch0",runTest:function(t){var _15f=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _160=function(_161,_162){t.assertEqual(_161.length,5);var _163=true;for(var i=0;i<_161.length;i++){var _164=_15f.getValue(_161[i],"abbr");if(!(_164==="ec"||_164==="eg"||_164==="er"||_164==="ee"||_164==="et")){_163=false;break;}}t.assertTrue(_163);if(_163){d.callback(true);}else{d.errback(new Error("Unexpected abbreviation found, match failure."));}};var _165=function(_166,_167){t.assertTrue(false);d.errback(_166);};_15f.fetch({query:{abbr:"e*"},onComplete:_160,onError:_165});return d;}},{name:"Read API: fetch() patternMatch0, complex",runTest:function(t){var _168=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _169=function(_16a,_16b){t.assertEqual(_16a.length,5);var _16c=true;for(var i=0;i<_16a.length;i++){var _16d=_168.getValue(_16a[i],"abbr");if(!(_16d==="ec"||_16d==="eg"||_16d==="er"||_16d==="ee"||_16d==="et")){_16c=false;break;}}t.assertTrue(_16c);if(_16c){d.callback(true);}else{d.errback(new Error("Unexpected abbreviation found, match failure."));}};var _16e=function(_16f,_170){t.assertTrue(false);d.errback(_16f);};_168.fetch({query:"abbr: \"e*\"",onComplete:_169,onError:_16e});return d;}},{name:"Read API: fetch() patternMatch1",runTest:function(t){var _171=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"boomBam"},{uniqueId:4,value:"bit$Bite"},{uniqueId:5,value:"ouagadogou"},{uniqueId:6,value:"BaBaMaSaRa***Foo"},{uniqueId:7,value:"squawl"},{uniqueId:8,value:"seaweed"},{uniqueId:9,value:"jfq4@#!$!@Rf14r14i5u"}]}});var d=new doh.Deferred();var _172=function(_173,_174){t.assertEqual(_173.length,2);var _175=true;for(var i=0;i<_173.length;i++){var _176=_171.getValue(_173[i],"value");if(!(_176==="bit$Bite"||_176==="jfq4@#!$!@Rf14r14i5u")){_175=false;break;}}t.assertTrue(_175);if(_175){d.callback(true);}else{d.errback(new Error("Unexpected pattern matched.  Filter failure."));}};var _177=function(_178,_179){t.assertTrue(false);d.errback(_178);};_171.fetch({query:{value:"*$*"},onComplete:_172,onError:_177});return d;}},{name:"Read API: fetch() patternMatch1, complex",runTest:function(t){var _17a=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"boomBam"},{uniqueId:4,value:"bit$Bite"},{uniqueId:5,value:"ouagadogou"},{uniqueId:6,value:"BaBaMaSaRa***Foo"},{uniqueId:7,value:"squawl"},{uniqueId:8,value:"seaweed"},{uniqueId:9,value:"jfq4@#!$!@Rf14r14i5u"}]}});var d=new doh.Deferred();var _17b=function(_17c,_17d){t.assertEqual(_17c.length,2);var _17e=true;for(var i=0;i<_17c.length;i++){var _17f=_17a.getValue(_17c[i],"value");if(!(_17f==="bit$Bite"||_17f==="jfq4@#!$!@Rf14r14i5u")){_17e=false;break;}}t.assertTrue(_17e);if(_17e){d.callback(true);}else{d.errback(new Error("Unexpected pattern matched.  Filter failure."));}};var _180=function(_181,_182){t.assertTrue(false);d.errback(_181);};_17a.fetch({query:"value: \"*$*\"",onComplete:_17b,onError:_180});return d;}},{name:"Read API: fetch() patternMatch2",runTest:function(t){var _183=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"boomBam"},{uniqueId:4,value:"bit$Bite"},{uniqueId:5,value:"ouagadogou"},{uniqueId:6,value:"BaBaMaSaRa***Foo"},{uniqueId:7,value:"squawl"},{uniqueId:8,value:"seaweed"},{uniqueId:9,value:"jfq4@#!$!@Rf14r14i5u"}]}});var d=new doh.Deferred();var _184=function(_185,_186){t.assertEqual(_185.length,1);var _187=true;for(var i=0;i<_185.length;i++){var _188=_183.getValue(_185[i],"value");if(!(_188==="bar*foo")){_187=false;break;}}t.assertTrue(_187);if(_187){d.callback(true);}else{d.errback(new Error("Unexpected abbreviation found, match failure."));}};var _189=function(_18a,_18b){t.assertTrue(false);d.errback(_18a);};_183.fetch({query:{value:"bar\\*foo"},onComplete:_184,onError:_189});return d;}},{name:"Read API: fetch() patternMatch2, complex",runTest:function(t){var _18c=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"boomBam"},{uniqueId:4,value:"bit$Bite"},{uniqueId:5,value:"ouagadogou"},{uniqueId:6,value:"BaBaMaSaRa***Foo"},{uniqueId:7,value:"squawl"},{uniqueId:8,value:"seaweed"},{uniqueId:9,value:"jfq4@#!$!@Rf14r14i5u"}]}});var d=new doh.Deferred();var _18d=function(_18e,_18f){t.assertEqual(_18e.length,1);var _190=true;for(var i=0;i<_18e.length;i++){var _191=_18c.getValue(_18e[i],"value");if(!(_191==="bar*foo")){_190=false;break;}}t.assertTrue(_190);if(_190){d.callback(true);}else{d.errback(new Error("Unexpected abbreviation found, match failure."));}};var _192=function(_193,_194){t.assertTrue(false);d.errback(_193);};_18c.fetch({query:"value: \"bar\\*foo\"",onComplete:_18d,onError:_192});return d;}},{name:"Read API: fetch() patternMatch_caseSensitive",runTest:function(t){var _195=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"BAR*foo"},{uniqueId:4,value:"BARBananafoo"}]}});var d=new doh.Deferred();var _196=function(_197,_198){t.assertEqual(1,_197.length);var _199=true;for(var i=0;i<_197.length;i++){var _19a=_195.getValue(_197[i],"value");if(!(_19a==="bar*foo")){_199=false;break;}}t.assertTrue(_199);if(_199){d.callback(true);}else{d.errback(new Error("Unexpected pattern matched.  Filter failure."));}};var _19b=function(_19c,_19d){t.assertTrue(false);d.errback(_19c);};_195.fetch({query:{value:"bar\\*foo"},queryOptions:{ignoreCase:false},onComplete:_196,onError:_19b});return d;}},{name:"Read API: fetch() patternMatch_caseSensitive, complex",runTest:function(t){var _19e=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"BAR*foo"},{uniqueId:4,value:"BARBananafoo"}]}});var d=new doh.Deferred();var _19f=function(_1a0,_1a1){t.assertEqual(1,_1a0.length);var _1a2=true;for(var i=0;i<_1a0.length;i++){var _1a3=_19e.getValue(_1a0[i],"value");if(!(_1a3==="bar*foo")){_1a2=false;break;}}t.assertTrue(_1a2);if(_1a2){d.callback(true);}else{d.errback(new Error("Unexpected pattern matched.  Filter failure."));}};var _1a4=function(_1a5,_1a6){t.assertTrue(false);d.errback(_1a5);};_19e.fetch({query:"value: \"bar\\*foo\"",queryOptions:{ignoreCase:false},onComplete:_19f,onError:_1a4});return d;}},{name:"Read API: fetch() patternMatch_caseInsensitive",runTest:function(t){var _1a7=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"BAR*foo"},{uniqueId:4,value:"BARBananafoo"}]}});var d=new doh.Deferred();var _1a8=function(_1a9,_1aa){t.assertEqual(_1a9.length,2);var _1ab=true;for(var i=0;i<_1a9.length;i++){var _1ac=_1a7.getValue(_1a9[i],"value");if(!(_1ac==="BAR*foo"||_1ac==="bar*foo")){_1ab=false;break;}}t.assertTrue(_1ab);if(_1ab){d.callback(true);}else{d.errback(new Error("Unexpected pattern matched.  Filter failure."));}};var _1ad=function(_1ae,_1af){t.assertTrue(false);d.errback(_1ae);};_1a7.fetch({query:{value:"bar\\*foo"},queryOptions:{ignoreCase:true},onComplete:_1a8,onError:_1ad});return d;}},{name:"Read API: fetch() patternMatch_caseInsensitive, complex",runTest:function(t){var _1b0=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"BAR*foo"},{uniqueId:4,value:"BARBananafoo"}]}});var d=new doh.Deferred();var _1b1=function(_1b2,_1b3){t.assertEqual(_1b2.length,2);var _1b4=true;for(var i=0;i<_1b2.length;i++){var _1b5=_1b0.getValue(_1b2[i],"value");if(!(_1b5==="BAR*foo"||_1b5==="bar*foo")){_1b4=false;break;}}t.assertTrue(_1b4);if(_1b4){d.callback(true);}else{d.errback(new Error("Unexpected pattern matched.  Filter failure."));}};var _1b6=function(_1b7,_1b8){t.assertTrue(false);d.errback(_1b7);};_1b0.fetch({query:"value: \"bar\\*foo\"",queryOptions:{ignoreCase:true},onComplete:_1b1,onError:_1b6});return d;}},{name:"Read API: fetch() sortNumeric",runTest:function(t){var _1b9=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:0,value:"fo|o*b.ar"},{uniqueId:1,value:"ba|r*foo"},{uniqueId:2,value:"boomBam"},{uniqueId:3,value:"bit$Bite"},{uniqueId:4,value:"ouagadogou"},{uniqueId:5,value:"jfq4@#!$!@|f1.$4r14i5u"},{uniqueId:6,value:"BaB{aMa|SaRa***F}oo"},{uniqueId:7,value:"squawl"},{uniqueId:9,value:"seaweed"},{uniqueId:10,value:"zulu"},{uniqueId:8,value:"seaweed"}]}});var d=new doh.Deferred();var _1ba=function(_1bb,_1bc){t.assertEqual(_1bb.length,11);var _1bd=true;for(var i=0;i<_1bb.length;i++){var _1be=_1b9.getValue(_1bb[i],"value");if(!(_1b9.getValue(_1bb[i],"uniqueId")===i)){_1bd=false;break;}}t.assertTrue(_1bd);if(_1bd){d.callback(true);}else{d.errback(new Error("Unexpected sorting order found, sort failure."));}};var _1bf=function(_1c0,_1c1){t.assertTrue(false);d.errback(_1c0);};var _1c2=[{attribute:"uniqueId"}];_1b9.fetch({onComplete:_1ba,onError:_1bf,sort:_1c2});return d;}},{name:"Read API: fetch() sortNumericDescending",runTest:function(t){var _1c3=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:0,value:"fo|o*b.ar"},{uniqueId:1,value:"ba|r*foo"},{uniqueId:2,value:"boomBam"},{uniqueId:3,value:"bit$Bite"},{uniqueId:4,value:"ouagadogou"},{uniqueId:5,value:"jfq4@#!$!@|f1.$4r14i5u"},{uniqueId:6,value:"BaB{aMa|SaRa***F}oo"},{uniqueId:7,value:"squawl"},{uniqueId:9,value:"seaweed"},{uniqueId:10,value:"zulu"},{uniqueId:8,value:"seaweed"}]}});var d=new doh.Deferred();var _1c4=function(_1c5,_1c6){t.assertEqual(_1c5.length,11);var _1c7=true;for(var i=0;i<_1c5.length;i++){var _1c8=_1c3.getValue(_1c5[i],"value");if(!((_1c5.length-(_1c3.getValue(_1c5[i],"uniqueId")+1))===i)){_1c7=false;break;}}t.assertTrue(_1c7);if(_1c7){d.callback(true);}else{d.errback(new Error("Unexpected sorting order found, sort failure."));}};var _1c9=function(_1ca,_1cb){t.assertTrue(false);d.errback(_1ca);};var _1cc=[{attribute:"uniqueId",descending:true}];_1c3.fetch({onComplete:_1c4,onError:_1c9,sort:_1cc});return d;}},{name:"Read API: fetch() sortNumericWithCount",runTest:function(t){var _1cd=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:0,value:"fo|o*b.ar"},{uniqueId:1,value:"ba|r*foo"},{uniqueId:2,value:"boomBam"},{uniqueId:3,value:"bit$Bite"},{uniqueId:4,value:"ouagadogou"},{uniqueId:5,value:"jfq4@#!$!@|f1.$4r14i5u"},{uniqueId:6,value:"BaB{aMa|SaRa***F}oo"},{uniqueId:7,value:"squawl"},{uniqueId:9,value:"seaweed"},{uniqueId:10,value:"zulu"},{uniqueId:8,value:"seaweed"}]}});var d=new doh.Deferred();var _1ce=function(_1cf,_1d0){t.assertEqual(_1cf.length,5);var _1d1=10;var _1d2=true;for(var i=0;i<_1cf.length;i++){var _1d3=_1cd.getValue(_1cf[i],"value");if(!(_1cd.getValue(_1cf[i],"uniqueId")===_1d1)){_1d2=false;break;}_1d1--;}t.assertTrue(_1d2);if(_1d2){d.callback(true);}else{d.errback(new Error("Unexpected sorting order found, sort failure."));}};var _1d4=function(_1d5,_1d6){t.assertTrue(false);d.errback(_1d5);};var _1d7=[{attribute:"uniqueId",descending:true}];_1cd.fetch({onComplete:_1ce,onError:_1d4,sort:_1d7,count:5});return d;}},{name:"Read API: fetch() sortAlphabetic",runTest:function(t){var _1d8=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:0,value:"abc"},{uniqueId:1,value:"bca"},{uniqueId:2,value:"abcd"},{uniqueId:3,value:"abcdefg"},{uniqueId:4,value:"lmnop"},{uniqueId:5,value:"foghorn"},{uniqueId:6,value:"qberty"},{uniqueId:7,value:"qwerty"},{uniqueId:8,value:""},{uniqueId:9,value:"seaweed"},{uniqueId:10,value:"123abc"}]}});var d=new doh.Deferred();var _1d9=function(_1da,_1db){var _1dc=["","123abc","abc","abcd","abcdefg","bca","foghorn","lmnop","qberty","qwerty","seaweed"];t.assertEqual(_1da.length,11);var _1dd=true;for(var i=0;i<_1da.length;i++){var _1de=_1d8.getValue(_1da[i],"value");if(!(_1d8.getValue(_1da[i],"value")===_1dc[i])){_1dd=false;break;}}t.assertTrue(_1dd);if(_1dd){d.callback(true);}else{d.errback(new Error("Unexpected sorting order found, sort failure."));}};var _1df=function(_1e0,_1e1){t.assertTrue(false);d.errback(_1e0);};var _1e2=[{attribute:"value"}];_1d8.fetch({onComplete:_1d9,onError:_1df,sort:_1e2});return d;}},{name:"Read API: fetch() sortAlphabeticDescending",runTest:function(t){var _1e3=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:0,value:"abc"},{uniqueId:1,value:"bca"},{uniqueId:2,value:"abcd"},{uniqueId:3,value:"abcdefg"},{uniqueId:4,value:"lmnop"},{uniqueId:5,value:"foghorn"},{uniqueId:6,value:"qberty"},{uniqueId:7,value:"qwerty"},{uniqueId:8,value:""},{uniqueId:9,value:"seaweed"},{uniqueId:10,value:"123abc"}]}});var d=new doh.Deferred();var _1e4=function(_1e5,_1e6){var _1e7=["","123abc","abc","abcd","abcdefg","bca","foghorn","lmnop","qberty","qwerty","seaweed"];_1e7=_1e7.reverse();t.assertEqual(_1e5.length,11);var _1e8=true;for(var i=0;i<_1e5.length;i++){var _1e9=_1e3.getValue(_1e5[i],"value");if(!(_1e3.getValue(_1e5[i],"value")===_1e7[i])){_1e8=false;break;}}t.assertTrue(_1e8);if(_1e8){d.callback(true);}else{d.errback(new Error("Unexpected sorting order found, sort failure."));}};var _1ea=function(_1eb,_1ec){t.assertTrue(false);d.errback(_1eb);};var _1ed=[{attribute:"value",descending:true}];_1e3.fetch({onComplete:_1e4,onError:_1ea,sort:_1ed});return d;}},{name:"Read API: fetch() sortDate",runTest:function(t){var _1ee=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:0,value:new Date(0)},{uniqueId:1,value:new Date(100)},{uniqueId:2,value:new Date(1000)},{uniqueId:3,value:new Date(2000)},{uniqueId:4,value:new Date(3000)},{uniqueId:5,value:new Date(4000)},{uniqueId:6,value:new Date(5000)},{uniqueId:7,value:new Date(6000)},{uniqueId:8,value:new Date(7000)},{uniqueId:9,value:new Date(8000)},{uniqueId:10,value:new Date(9000)}]}});var d=new doh.Deferred();var _1ef=function(_1f0,_1f1){var _1f2=[0,100,1000,2000,3000,4000,5000,6000,7000,8000,9000];t.assertEqual(_1f0.length,11);var _1f3=true;for(var i=0;i<_1f0.length;i++){var _1f4=_1ee.getValue(_1f0[i],"value");if(!(_1ee.getValue(_1f0[i],"value").getTime()===_1f2[i])){_1f3=false;break;}}t.assertTrue(_1f3);if(_1f3){d.callback(true);}else{d.errback(new Error("Unexpected sorting order found, sort failure."));}};var _1f5=function(_1f6,_1f7){t.assertTrue(false);d.errback(_1f6);};var _1f8=[{attribute:"value"}];_1ee.fetch({onComplete:_1ef,onError:_1f5,sort:_1f8});return d;}},{name:"Read API: fetch() sortDateDescending",runTest:function(t){var _1f9=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:0,value:new Date(0)},{uniqueId:1,value:new Date(100)},{uniqueId:2,value:new Date(1000)},{uniqueId:3,value:new Date(2000)},{uniqueId:4,value:new Date(3000)},{uniqueId:5,value:new Date(4000)},{uniqueId:6,value:new Date(5000)},{uniqueId:7,value:new Date(6000)},{uniqueId:8,value:new Date(7000)},{uniqueId:9,value:new Date(8000)},{uniqueId:10,value:new Date(9000)}]}});var d=new doh.Deferred();var _1fa=function(_1fb,_1fc){var _1fd=[0,100,1000,2000,3000,4000,5000,6000,7000,8000,9000];_1fd=_1fd.reverse();t.assertEqual(_1fb.length,11);var _1fe=true;for(var i=0;i<_1fb.length;i++){var _1ff=_1f9.getValue(_1fb[i],"value");if(!(_1f9.getValue(_1fb[i],"value").getTime()===_1fd[i])){_1fe=false;break;}}t.assertTrue(_1fe);if(_1fe){d.callback(true);}else{d.errback(new Error("Unexpected sorting order found, sort failure."));}};var _200=function(_201,_202){t.assertTrue(false);d.errback(_201);};var _203=[{attribute:"value",descending:true}];_1f9.fetch({onComplete:_1fa,onError:_200,sort:_203});return d;}},{name:"Read API: fetch() sortMultiple",runTest:function(t){var _204=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"fo|o*b.ar"},{uniqueId:2,value:"ba|r*foo"},{uniqueId:3,value:"boomBam"},{uniqueId:4,value:"bit$Bite"},{uniqueId:5,value:"ouagadogou"},{uniqueId:6,value:"jfq4@#!$!@|f1.$4r14i5u"},{uniqueId:7,value:"BaB{aMa|SaRa***F}oo"},{uniqueId:8,value:"squawl"},{uniqueId:10,value:"seaweed"},{uniqueId:12,value:"seaweed"},{uniqueId:11,value:"zulu"},{uniqueId:9,value:"seaweed"}]}});var d=new doh.Deferred();var _205=function(_206,_207){var _208=[7,2,4,3,1,6,5,12,10,9,8,11];var _209=["BaB{aMa|SaRa***F}oo","ba|r*foo","bit$Bite","boomBam","fo|o*b.ar","jfq4@#!$!@|f1.$4r14i5u","ouagadogou","seaweed","seaweed","seaweed","squawl","zulu"];var _20a=true;for(var i=0;i<_206.length;i++){var _20b=_204.getValue(_206[i],"value");if(!((_204.getValue(_206[i],"uniqueId")===_208[i])&&(_204.getValue(_206[i],"value")===_209[i]))){_20a=false;break;}}t.assertTrue(_20a);if(_20a){d.callback(true);}else{d.errback(new Error("Unexpected sorting order found, sort failure."));}};var _20c=function(_20d,_20e){t.assertTrue(false);d.errback(_20d);};var _20f=[{attribute:"value"},{attribute:"uniqueId",descending:true}];_204.fetch({onComplete:_205,onError:_20c,sort:_20f});return d;}},{name:"Read API: fetch() sortMultipleSpecialComparator",runTest:function(t){var _210=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:1,status:"CLOSED"},{uniqueId:2,status:"OPEN"},{uniqueId:3,status:"PENDING"},{uniqueId:4,status:"BLOCKED"},{uniqueId:5,status:"CLOSED"},{uniqueId:6,status:"OPEN"},{uniqueId:7,status:"PENDING"},{uniqueId:8,status:"PENDING"},{uniqueId:10,status:"BLOCKED"},{uniqueId:12,status:"BLOCKED"},{uniqueId:11,status:"OPEN"},{uniqueId:9,status:"CLOSED"}]}});_210.comparatorMap={};_210.comparatorMap["status"]=function(a,b){var ret=0;var _211={OPEN:3,BLOCKED:2,PENDING:1,CLOSED:0};if(_211[a]>_211[b]){ret=1;}if(_211[a]<_211[b]){ret=-1;}return ret;};var _212=[{attribute:"status",descending:true},{attribute:"uniqueId",descending:true}];var d=new doh.Deferred();var _213=function(_214,_215){var _216=[11,6,2,12,10,4,8,7,3,9,5,1];var _217=true;for(var i=0;i<_214.length;i++){var _218=_210.getValue(_214[i],"value");if(!(_210.getValue(_214[i],"uniqueId")===_216[i])){_217=false;break;}}t.assertTrue(_217);if(_217){d.callback(true);}else{d.errback(new Error("Unexpected sorting order found, sort failure."));}};var _219=function(_21a,_21b){t.assertTrue(false);d.errback(_21a);};_210.fetch({onComplete:_213,onError:_219,sort:_212});return d;}},{name:"Read API: fetch() sortAlphabeticWithUndefined",runTest:function(t){var _21c=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:0,value:"abc"},{uniqueId:1,value:"bca"},{uniqueId:2,value:"abcd"},{uniqueId:3,value:"abcdefg"},{uniqueId:4,value:"lmnop"},{uniqueId:5,value:"foghorn"},{uniqueId:6,value:"qberty"},{uniqueId:7,value:"qwerty"},{uniqueId:8},{uniqueId:9,value:"seaweed"},{uniqueId:10,value:"123abc"}]}});var d=new doh.Deferred();var _21d=function(_21e,_21f){var _220=[10,0,2,3,1,5,4,6,7,9,8];t.assertEqual(_21e.length,11);var _221=true;for(var i=0;i<_21e.length;i++){if(!(_21c.getValue(_21e[i],"uniqueId")===_220[i])){_221=false;break;}}t.assertTrue(_221);if(_221){d.callback(true);}else{d.errback(new Error("Unexpected sorting order found, sort failure."));}};var _222=function(_223,_224){t.assertTrue(false);d.errback(_223);};var _225=[{attribute:"value"}];_21c.fetch({onComplete:_21d,onError:_222,sort:_225});return d;}},{name:"Read API: errorCondition_idCollision_inMemory",runTest:function(t){var _226=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:12345,value:"foo"},{uniqueId:123456,value:"bar"},{uniqueId:12345,value:"boom"},{uniqueId:123457,value:"bit"}]}});var d=new doh.Deferred();var _227=function(_228,_229){t.assertTrue(false);d.callback(false);};var _22a=function(_22b,_22c){t.assertTrue(true);d.callback(true);};_226.fetch({onComplete:_227,onError:_22a});return d;}},{name:"Read API: errorCondition_idCollision_xhr",runTest:function(t){if(_1.isBrowser){var _22d=new _3.data.AndOrReadStore({url:_1.moduleUrl("tests","data/countries_idcollision.json").toString()});var d=new doh.Deferred();var _22e=function(_22f,_230){t.assertTrue(false);d.callback(false);};var _231=function(_232,_233){t.assertTrue(true);d.callback(true);};_22d.fetch({onComplete:_22e,onError:_231});return d;}}},{name:"Read API: Date_datatype",runTest:function(t){var _234=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries_withDates"));var d=new doh.Deferred();var _235=function(item){t.assertTrue(item!==null);var _236=_234.getValue(item,"independence");t.assertTrue(_236 instanceof Date);t.assertTrue(_1.date.stamp.toISOString(_236,{zulu:true})==="1993-05-24T00:00:00Z");d.callback(true);};var _237=function(_238){t.assertTrue(false);d.errback(_238);};_234.fetchItemByIdentity({identity:"er",onItem:_235,onError:_237});return d;}},{name:"Read API: custom_datatype_Color_SimpleMapping",runTest:function(t){var _239={identifier:"name",items:[{name:"Kermit",species:"frog",color:{_type:"Color",_value:"green"}},{name:"Beaker",hairColor:{_type:"Color",_value:"red"}}]};var _23a=new _3.data.AndOrReadStore({data:_239,typeMap:{"Color":_1.Color}});var d=new doh.Deferred();var _23b=function(item){t.assertTrue(item!==null);var _23c=item;var _23d=_23a.getValue(_23c,"hairColor");t.assertTrue(_23d instanceof _1.Color);t.assertTrue(_23d.toHex()=="#ff0000");d.callback(true);};var _23e=function(_23f){d.errback(_23f);};_23a.fetchItemByIdentity({identity:"Beaker",onItem:_23b,onError:_23e});return d;}},{name:"Read API: custom_datatype_Color_GeneralMapping",runTest:function(t){var _240={identifier:"name",items:[{name:"Kermit",species:"frog",color:{_type:"Color",_value:"green"}},{name:"Beaker",hairColor:{_type:"Color",_value:"red"}}]};var _241=new _3.data.AndOrReadStore({data:_240,typeMap:{"Color":{type:_1.Color,deserialize:function(_242){return new _1.Color(_242);}}}});var d=new doh.Deferred();var _243=function(item){t.assertTrue(item!==null);var _244=item;var _245=_241.getValue(_244,"hairColor");t.assertTrue(_245 instanceof _1.Color);t.assertTrue(_245.toHex()=="#ff0000");d.callback(true);};var _246=function(_247){d.errback(_247);};_241.fetchItemByIdentity({identity:"Beaker",onItem:_243,onError:_246});return d;}},{name:"Read API: custom_datatype_CustomObject 0 (False) value",runTest:function(t){var _248={identifier:"name",items:[{name:"Bob",species:"human",age:{_type:"dojox.data.tests.Wrapper",_value:0}},{name:"Nancy",species:"human",age:{_type:"dojox.data.tests.Wrapper",_value:32}}]};var _249=new _3.data.AndOrReadStore({data:_248,typeMap:{"dojox.data.tests.Wrapper":{type:_3.data.tests.Wrapper,deserialize:function(_24a){return new _3.data.tests.Wrapper(_24a);}}}});var d=new doh.Deferred();function _24b(item){t.assertTrue(item!==null);var bob=item;var age=_249.getValue(item,"age");t.assertTrue(age instanceof _3.data.tests.Wrapper);t.assertTrue(age.toString()=="WRAPPER: [0]");d.callback(true);};function _24c(_24d){d.errback(_24d);};_249.fetchItemByIdentity({identity:"Bob",onItem:_24b,onError:_24c});return d;}},{name:"Read API: custom_datatype_CustomObject Boolean False values",runTest:function(t){var _24e={identifier:"name",items:[{name:"Bob",isHuman:{_type:"dojox.data.tests.Wrapper",_value:false}},{name:"Nancy",isHuman:{_type:"dojox.data.tests.Wrapper",_value:true}}]};var _24f=new _3.data.AndOrReadStore({data:_24e,typeMap:{"dojox.data.tests.Wrapper":{type:_3.data.tests.Wrapper,deserialize:function(_250){return new _3.data.tests.Wrapper(_250);}}}});var d=new doh.Deferred();function _251(item){t.assertTrue(item!==null);var bob=item;var _252=_24f.getValue(item,"isHuman");t.assertTrue(_252 instanceof _3.data.tests.Wrapper);t.assertTrue(_252.toString()=="WRAPPER: [false]");d.callback(true);};function _253(_254){d.errback(_254);};_24f.fetchItemByIdentity({identity:"Bob",onItem:_251,onError:_253});return d;}},{name:"Read API: custom_datatype_CustomObject Empty String values",runTest:function(t){var _255={identifier:"name",items:[{name:"Bob",lastName:{_type:"dojox.data.tests.Wrapper",_value:""}},{name:"Nancy",lastName:{_type:"dojox.data.tests.Wrapper",_value:"Doe"}}]};var _256=new _3.data.AndOrReadStore({data:_255,typeMap:{"dojox.data.tests.Wrapper":{type:_3.data.tests.Wrapper,deserialize:function(_257){return new _3.data.tests.Wrapper(_257);}}}});var d=new doh.Deferred();function _258(item){t.assertTrue(item!==null);var bob=item;var _259=_256.getValue(item,"lastName");t.assertTrue(_259 instanceof _3.data.tests.Wrapper);t.assertTrue(_259.toString()=="WRAPPER: []");d.callback(true);};function _25a(_25b){d.errback(_25b);};_256.fetchItemByIdentity({identity:"Bob",onItem:_258,onError:_25a});return d;}},{name:"Read API: custom_datatype_CustomObject explicit null values",runTest:function(t){var _25c={identifier:"name",items:[{name:"Bob",lastName:{_type:"dojox.data.tests.Wrapper",_value:null}},{name:"Nancy",lastName:{_type:"dojox.data.tests.Wrapper",_value:"Doe"}}]};var _25d=new _3.data.AndOrReadStore({data:_25c,typeMap:{"dojox.data.tests.Wrapper":{type:_3.data.tests.Wrapper,deserialize:function(_25e){return new _3.data.tests.Wrapper(_25e);}}}});var d=new doh.Deferred();function _25f(item){t.assertTrue(item!==null);var bob=item;var _260=_25d.getValue(item,"lastName");t.assertTrue(_260 instanceof _3.data.tests.Wrapper);t.assertTrue(_260.toString()=="WRAPPER: [null]");d.callback(true);};function _261(_262){d.errback(_262);};_25d.fetchItemByIdentity({identity:"Bob",onItem:_25f,onError:_261});return d;}},{name:"Read API: custom_datatype_CustomObject explicit undefined value",runTest:function(t){var _263={identifier:"name",items:[{name:"Bob",lastName:{_type:"dojox.data.tests.Wrapper",_value:undefined}},{name:"Nancy",lastName:{_type:"dojox.data.tests.Wrapper",_value:"Doe"}}]};var _264=new _3.data.AndOrReadStore({data:_263,typeMap:{"dojox.data.tests.Wrapper":{type:_3.data.tests.Wrapper,deserialize:function(_265){return new _3.data.tests.Wrapper(_265);}}}});var d=new doh.Deferred();function _266(item){t.assertTrue(item!==null);var bob=item;var _267=_264.getValue(item,"lastName");t.assertTrue(_267 instanceof _3.data.tests.Wrapper);t.assertTrue(_267.toString()=="WRAPPER: [undefined]");d.callback(true);};function _268(_269){d.errback(_269);};_264.fetchItemByIdentity({identity:"Bob",onItem:_266,onError:_268});return d;}},{name:"Read API: hierarchical_data",runTest:function(t){var _26a=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("geography_hierarchy_small"));var d=new doh.Deferred();var _26b=function(_26c,_26d){t.assertEqual(_26c.length,1);var _26e=_26c[0];var _26f=_26a.getValue(_26e,"countries");var _270=_26a.getValue(_26f,"cities");t.assertEqual(_26a.getValue(_26f,"name"),"Canada");t.assertEqual(_26a.getValue(_270,"name"),"Toronto");d.callback(true);};var _271=function(_272){d.errback(_272);};_26a.fetch({query:{name:"North America"},onComplete:_26b,onError:_271});return d;}},{name:"Read API: hierarchical_data, complex",runTest:function(t){var _273=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("geography_hierarchy_small"));var d=new doh.Deferred();var _274=function(_275,_276){t.assertEqual(_275.length,1);var _277=_275[0];var _278=_273.getValue(_277,"countries");var _279=_273.getValue(_278,"cities");t.assertEqual(_273.getValue(_278,"name"),"Canada");t.assertEqual(_273.getValue(_279,"name"),"Toronto");d.callback(true);};var _27a=function(_27b){d.errback(_27b);};_273.fetch({query:"name: \"North America\"",onComplete:_274,onError:_27a});return d;}},{name:"Read API: close (clearOnClose: true, reset url.)",runTest:function(t){if(_1.isBrowser){var _27c=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));_27c.clearOnClose=true;_27c.urlPreventCache=true;var d=new doh.Deferred();function _27d(item){var _27e=null;try{t.assertTrue(item!==null);var ec=item;var val=_27c.getValue(ec,"name");t.assertEqual("Ecuador",val);_27c.close();t.assertTrue(_27c._arrayOfAllItems.length===0);t.assertTrue(_27c._loadFinished===false);_27c.url=_1.moduleUrl("dojox","data/tests/stores/countries_withNull.json").toString();function _27f(item){var err;try{t.assertTrue(item!==null);var val=_27c.getValue(item,"name");t.assertEqual(null,val);}catch(e){err=e;}if(err){d.errback(err);}else{d.callback(true);}};_27c.fetchItemByIdentity({identity:"ec",onItem:_27f,onError:_280});}catch(e){_27e=e;}if(_27e){d.errback(_27e);}};function _280(_281){d.errback(_281);};_27c.fetchItemByIdentity({identity:"ec",onItem:_27d,onError:_280});return d;}}},{name:"Read API: fetch, close (clearOnClose: true, reset url.)",runTest:function(t){if(_1.isBrowser){var _282=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));_282.clearOnClose=true;_282.urlPreventCache=true;var d=new doh.Deferred();function _283(item){var _284=null;try{t.assertTrue(item!==null);var ec=item;var val=_282.getValue(ec,"name");t.assertEqual("Ecuador",val);_282.close();t.assertTrue(_282._arrayOfAllItems.length===0);t.assertTrue(_282._loadFinished===false);_282.url=_1.moduleUrl("dojox","data/tests/stores/countries_withNull.json").toString();function _285(_286){var err;try{t.assertEqual(1,_286.length);var item=_286[0];t.assertTrue(item!==null);var val=_282.getValue(item,"name");t.assertEqual(null,val);}catch(e){err=e;}if(err){d.errback(err);}else{d.callback(true);}};_282.fetch({query:{abbr:"ec"},onComplete:_285,onError:_287});}catch(e){_284=e;}if(_284){d.errback(_284);}};function _287(_288){d.errback(_288);};_282.fetchItemByIdentity({identity:"ec",onItem:_283,onError:_287});return d;}}},{name:"Read API: close (clearOnClose: true, reset _jsonFileUrl.)",runTest:function(t){if(_1.isBrowser){var _289=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));_289.clearOnClose=true;_289.urlPreventCache=true;var d=new doh.Deferred();function _28a(item){var _28b=null;try{t.assertTrue(item!==null);var ec=item;var val=_289.getValue(ec,"name");t.assertEqual("Ecuador",val);_289.close();t.assertTrue(_289._arrayOfAllItems.length===0);t.assertTrue(_289._loadFinished===false);_289._jsonFileUrl=_1.moduleUrl("dojox","data/tests/stores/countries_withNull.json").toString();function _28c(item){var err;try{t.assertTrue(item!==null);var val=_289.getValue(item,"name");t.assertEqual(null,val);}catch(e){err=e;}if(err){d.errback(err);}else{d.callback(true);}};_289.fetchItemByIdentity({identity:"ec",onItem:_28c,onError:_28d});}catch(e){_28b=e;}if(_28b){d.errback(_28b);}};function _28d(_28e){d.errback(_28e);};_289.fetchItemByIdentity({identity:"ec",onItem:_28a,onError:_28d});return d;}}},{name:"Read API: close (clearOnClose: true, reset data.)",runTest:function(t){var _28f=new _3.data.AndOrReadStore({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"boomBam"},{uniqueId:4,value:"bit$Bite"},{uniqueId:5,value:"ouagadogou"},{uniqueId:6,value:"BaBaMaSaRa***Foo"},{uniqueId:7,value:"squawl"},{uniqueId:8,value:"seaweed"},{uniqueId:9,value:"jfq4@#!$!@Rf14r14i5u"}]}});var d=new doh.Deferred();var _290=function(_291,_292){t.assertEqual(_291.length,1);var _293=_291[0];_28f.clearOnClose=true;_28f.data={identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"boomBam"},{uniqueId:4,value:"bit$Bite"},{uniqueId:5,value:"ouagadogou"},{uniqueId:6,value:"BaBaMaSaRa***Foo"},{uniqueId:7,value:"squawl"},{uniqueId:8,value:"seaweed"},{uniqueId:9,value:"jfq4@#!$!@Rf14r14i5u"}]};_28f.close();var _294=function(_295,_296){try{t.assertEqual(_295.length,1);var _297=_295[0];t.assertTrue(_293!=null);t.assertTrue(_297!=null);t.assertTrue(_293!=_297);d.callback(true);}catch(e){d.errback(e);}};_28f.fetch({query:{value:"bar*foo"},onComplete:_294,onError:_298});};function _298(_299,_29a){t.assertTrue(false);d.errback(_299);};_28f.fetch({query:{value:"bar*foo"},onComplete:_290,onError:_298});return d;}},{name:"Identity API: no_identifier_specified",runTest:function(t){var _29b=[{name:"Kermit",color:"green"},{name:"Miss Piggy",likes:"Kermit"},{name:"Beaker",hairColor:"red"}];var _29c=new _3.data.AndOrReadStore({data:{items:_29b}});var d=new doh.Deferred();var _29d=function(_29e,_29f){var _2a0=_29c.getFeatures();var _2a1=Boolean(_2a0["dojo.data.api.Identity"]);t.assertTrue(_2a1);for(var i=0;i<_29e.length;++i){var item=_29e[i];var _2a2=_29c.getIdentityAttributes(item);t.assertTrue(_2a2===null);var _2a3=_29c.getIdentity(item);t.assertTrue(typeof _2a3=="number");}d.callback(true);};var _2a4=function(_2a5,_2a6){d.errback(true);};_29c.fetch({onComplete:_29d,onError:_2a4});return d;}},{name:"Identity API: hierarchical_data",runTest:function(t){var _2a7=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("geography_hierarchy_small"));var d=new doh.Deferred();var _2a8=function(_2a9,_2aa){var _2ab=_2a7.getFeatures();var _2ac=Boolean(_2ab["dojo.data.api.Identity"]);t.assertTrue(_2ac);for(var i=0;i<_2a9.length;++i){var item=_2a9[i];var _2ad=_2a7.getIdentityAttributes(item);t.assertTrue(_2ad===null);var _2ae=_2a7.getIdentity(item);t.assertTrue(typeof _2ae=="number");}d.callback(true);};var _2af=function(_2b0,_2b1){d.errback(true);};_2a7.fetch({onComplete:_2a8,onError:_2af});return d;}},{name:"Read API: functionConformance",runTest:function(t){var _2b2=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var _2b3=new _1.data.api.Read();var _2b4=true;for(var i in _2b3){if(i.toString().charAt(0)!=="_"){var _2b5=_2b3[i];if(typeof _2b5==="function"){var _2b6=_2b2[i];if(!(typeof _2b6==="function")){_2b4=false;break;}}}}t.assertTrue(_2b4);}},{name:"Identity API: functionConformance",runTest:function(t){var _2b7=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var _2b8=new _1.data.api.Identity();var _2b9=true;for(var i in _2b8){if(i.toString().charAt(0)!=="_"){var _2ba=_2b8[i];if(typeof _2ba==="function"){var _2bb=_2b7[i];if(!(typeof _2bb==="function")){_2b9=false;break;}}}}t.assertTrue(_2b9);}},{name:"Read API: fetch() multiple, OR, complex",runTest:function(t){var _2bc=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _2bd=function(_2be,_2bf){t.assertEqual(_2be.length,3);d.callback(true);};var _2c0=function(_2c1,_2c2){t.assertTrue(false);d.errback(_2c1);};_2bc.fetch({query:"abbr: \"s*\" || capital:\"A*\"",onComplete:_2bd,onError:_2c0});return d;}},{name:"Read API: fetch() multiple, AND(OR, complex",runTest:function(t){var _2c3=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _2c4=function(_2c5,_2c6){t.assertEqual(_2c5.length,3);d.callback(true);};var _2c7=function(_2c8,_2c9){t.assertTrue(false);d.errback(_2c8);};_2c3.fetch({query:"abbr: \"e*\" AND (capital:\"A*\" or capital: \"Q*\")",onComplete:_2c4,onError:_2c7});return d;}},{name:"Read API: fetch() multiple, AND(OR, as json object, complex",runTest:function(t){var _2ca=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _2cb=function(_2cc,_2cd){t.assertEqual(_2cc.length,3);d.callback(true);};var _2ce=function(_2cf,_2d0){t.assertTrue(false);d.errback(_2cf);};_2ca.fetch({query:{complexQuery:"abbr: \"e*\" AND (capital:\"A*\" or capital: \"Q*\")"},onComplete:_2cb,onError:_2ce});return d;}},{name:"Read API: fetch() multiple, AND/OR, as json object, complex, with extra attrs",runTest:function(t){var _2d1=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _2d2=function(_2d3,_2d4){t.assertEqual(_2d3.length,1);d.callback(true);};var _2d5=function(_2d6,_2d7){t.assertTrue(false);d.errback(_2d6);};_2d1.fetch({query:{complexQuery:"abbr: \"e*\" AND (capital:\"A*\" or capital: \"Q*\")",name:"Ec*"},onComplete:_2d2,onError:_2d5});return d;}},{name:"Read API: fetch() multiple, AND/OR, as json object, complex, with extra attrs and spaces",runTest:function(t){var _2d8=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _2d9=function(_2da,_2db){t.assertEqual(_2da.length,1);t.assertEqual("Equatorial Guinea",_2d8.getValue(_2da[0],"name"));d.callback(true);};var _2dc=function(_2dd,_2de){t.assertTrue(false);d.errback(_2dd);};_2d8.fetch({query:{complexQuery:"abbr: \"g*\" AND (capital:\"A*\" or capital: \"M*\")",name:"Equatorial G*"},onComplete:_2d9,onError:_2dc});return d;}},{name:"Read API: fetch() multiple, AND/OR, as quoted json object, complex",runTest:function(t){var _2df=new _3.data.AndOrReadStore(_3.data.tests.stores.AndOrReadStore.getTestData("countries"));var d=new doh.Deferred();var _2e0=function(_2e1,_2e2){t.assertEqual(_2e1.length,3);d.callback(true);};var _2e3=function(_2e4,_2e5){t.assertTrue(false);d.errback(_2e4);};_2df.fetch({query:"{complexQuery:'abbr: \"e*\" AND (capital:\"A*\" or capital: \"Q*\")'}",onComplete:_2e0,onError:_2e3});return d;}}];return _3.data.tests.stores.AndOrReadStore.tests;};doh.register("dojox.data.tests.stores.AndOrReadStore",_3.data.tests.stores.AndOrReadStore.getTests());});require(["dojox/data/tests/stores/AndOrReadStore"]);