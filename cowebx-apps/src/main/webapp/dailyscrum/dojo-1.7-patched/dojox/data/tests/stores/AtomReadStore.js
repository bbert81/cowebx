/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo","dijit","dojox","dojox/data/AtomReadStore","dojo/data/api/Read"],function(_1,_2,_3){_1.getObject("dojox.data.tests.stores.AtomReadStore",1);_3.data.tests.stores.AtomReadStore.getBlog1Store=function(){return new _3.data.AtomReadStore({url:_1.moduleUrl("dojox.data.tests","stores/atom1.xml").toString()});};_3.data.tests.stores.AtomReadStore.error=function(t,d,_4){d.errback(_4);};doh.register("dojox.data.tests.stores.AtomReadStore",[{name:"ReadAPI:  Fetch_One",timeout:5000,runTest:function(t){var _5=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _6(_7,_8){t.is(1,_7.length);d.callback(true);};_5.fetch({query:{},count:1,onComplete:_6,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,doh,d)});return d;}},{name:"ReadAPI:  Fetch_5_Streaming",timeout:5000,runTest:function(t){var _9=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();var _a=0;function _b(_c,_d){t.assertTrue(_9.isItem(_c));_a++;};function _e(_f,_10){t.is(5,_a);t.is(null,_f);d.callback(true);};_9.fetch({query:{},onBegin:null,count:5,onItem:_b,onComplete:_e,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},{name:"ReadAPI:  Fetch_Paging",timeout:5000,runTest:function(t){var _11=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _12(_13,_14){t.is(5,_13.length);_14.start=3;_14.count=1;_14.onComplete=_15;_11.fetch(_14);};function _15(_16,_17){t.is(1,_16.length);_17.start=0;_17.count=5;_17.onComplete=_18;_11.fetch(_17);};function _18(_19,_1a){t.is(5,_19.length);_1a.start=2;_1a.count=18;_1a.onComplete=_1b;_11.fetch(_1a);};function _1b(_1c,_1d){t.is(18,_1c.length);_1d.start=5;_1d.count=11;_1d.onComplete=_1e;_11.fetch(_1d);};function _1e(_1f,_20){t.is(11,_1f.length);_20.start=4;_20.count=16;_20.onComplete=_21;_11.fetch(_20);};function _21(_22,_23){t.is(16,_22.length);d.callback(true);};function _24(_25,_26){t.is(7,_25.length);_26.start=1;_26.count=5;_26.onComplete=_12;_11.fetch(_26);};_11.fetch({query:{},count:7,onComplete:_24,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},{name:"ReadAPI:  getLabel",timeout:5000,runTest:function(t){var _27=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _28(_29,_2a){t.assertEqual(_29.length,1);var _2b=_27.getLabel(_29[0]);t.assertTrue(_2b!==null);d.callback(true);};_27.fetch({query:{},count:1,onComplete:_28,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},{name:"ReadAPI:  getLabelAttributes",timeout:5000,runTest:function(t){var _2c=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _2d(_2e,_2f){t.assertEqual(_2e.length,1);var _30=_2c.getLabelAttributes(_2e[0]);t.assertTrue(_1.isArray(_30));t.assertEqual("title",_30[0]);d.callback(true);};_2c.fetch({query:{},count:1,onComplete:_2d,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},{name:"ReadAPI:  getValue",timeout:5000,runTest:function(t){var _31=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _32(_33){t.is(1,_33.length);t.assertTrue(_31.getValue(_33[0],"summary")!==null);t.assertTrue(_31.getValue(_33[0],"content")!==null);t.assertTrue(_31.getValue(_33[0],"published")!==null);t.assertTrue(_31.getValue(_33[0],"updated")!==null);t.assertTrue(_31.getValue(_33[0],"updated").getFullYear);d.callback(true);};_31.fetch({query:{},count:1,onComplete:_32,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},{name:"ReadAPI:  getValue_Failure",timeout:5000,runTest:function(t){var _34=_3.data.tests.stores.AtomReadStore.getBlog1Store();var _35=false;try{var _36=_34.getValue("NotAnItem","foo");}catch(e){_35=true;}t.assertTrue(_35);}},{name:"ReadAPI:  getValues",timeout:5000,runTest:function(t){var _37=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _38(_39){t.is(1,_39.length);var _3a=_37.getValues(_39[0],"summary");t.assertTrue(_1.isArray(_3a));var _3b=_37.getValues(_39[0],"content");t.assertTrue(_1.isArray(_3b));var _3c=_37.getValues(_39[0],"published");t.assertTrue(_1.isArray(_3c));var _3d=_37.getValues(_39[0],"updated");t.assertTrue(_1.isArray(_3d));d.callback(true);};_37.fetch({query:{},count:1,onComplete:_38,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},{name:"ReadAPI:  getValues_Failure",timeout:5000,runTest:function(t){var _3e=_3.data.tests.stores.AtomReadStore.getBlog1Store();var _3f=false;try{var _40=_3e.getValues("NotAnItem","foo");}catch(e){_3f=true;}t.assertTrue(_3f);}},{name:"ReadAPI:  isItem",timeout:5000,runTest:function(t){var _41=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _42(_43){t.is(5,_43.length);for(var i=0;i<_43.length;i++){t.assertTrue(_41.isItem(_43[i]));}d.callback(true);};_41.fetch({query:{},count:5,onComplete:_42,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},{name:"ReadAPI:  hasAttribute",timeout:5000,runTest:function(t){var _44=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _45(_46){t.is(1,_46.length);t.assertTrue(_46[0]!==null);var _47=0;t.assertTrue(_44.hasAttribute(_46[0],"author"));t.assertTrue(_44.hasAttribute(_46[0],"published"));t.assertTrue(_44.hasAttribute(_46[0],"updated"));t.assertTrue(_44.hasAttribute(_46[0],"category"));t.assertTrue(_44.hasAttribute(_46[0],"id"));t.assertTrue(!_44.hasAttribute(_46[0],"foo"));t.assertTrue(!_44.hasAttribute(_46[0],"bar"));t.assertTrue(_44.hasAttribute(_46[0],"summary"));t.assertTrue(_44.hasAttribute(_46[0],"content"));t.assertTrue(_44.hasAttribute(_46[0],"title"));var _48=_44.getValue(_46[0],"summary");var _49=_44.getValue(_46[0],"content");var _4a=_44.getValue(_46[0],"title");t.assertTrue(_48&&_48.text&&_48.type=="html");t.assertTrue(_49&&_49.text&&_49.type=="html");t.assertTrue(_4a&&_4a.text&&_4a.type=="html");try{_44.hasAttribute(_46[0],null);t.assertTrue(false);}catch(e){}d.callback(true);};_44.fetch({query:{},count:1,onComplete:_45,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},{name:"ReadAPI:  containsValue",timeout:5000,runTest:function(t){var _4b=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _4c(_4d){t.is(1,_4d.length);t.assertTrue(_4b.containsValue(_4d[0],"id","http://shaneosullivan.wordpress.com/2008/01/22/using-aol-hosted-dojo-with-your-custom-code/"));d.callback(true);};_4b.fetch({query:{},count:1,onComplete:_4c,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},{name:"ReadAPI:  getAttributes",timeout:5000,runTest:function(t){var _4e=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _4f(_50){t.is(1,_50.length);t.assertTrue(_4e.isItem(_50[0]));var _51=_4e.getAttributes(_50[0]);t.is(10,_51.length);d.callback(true);};_4e.fetch({query:{},count:1,onComplete:_4f,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},{name:"ReadAPI:  fetch_Category",timeout:5000,runTest:function(t){var _52=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _53(_54){t.is(2,_54.length);t.assertTrue(_52.isItem(_54[0]));t.assertTrue(_52.isItem(_54[1]));var _55=_52.getValues(_54[0],"category");t.assertTrue(_1.some(_55,function(_56){return _56.term=="aol";}));_55=_52.getValues(_54[1],"category");t.assertTrue(_1.some(_55,function(_57){return _57.term=="aol";}));d.callback(true);};_52.fetch({query:{category:"aol"},onComplete:_53,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},{name:"ReadAPI:  fetch_byID",timeout:5000,runTest:function(t){var _58=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _59(_5a){t.is(1,_5a.length);t.assertTrue(_58.isItem(_5a[0]));var _5b=_58.getValue(_5a[0],"title");t.assertTrue(_5b.text=="Dojo Grid has landed");d.callback(true);};_58.fetch({query:{id:"http://shaneosullivan.wordpress.com/2007/10/05/dojo-grid-has-landed/"},onComplete:_59,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},{name:"ReadAPI:  fetch_alternate",timeout:5000,runTest:function(t){var _5c=_3.data.tests.stores.AtomReadStore.getBlog1Store();var d=new doh.Deferred();function _5d(_5e){t.is(1,_5e.length);t.assertTrue(_5c.isItem(_5e[0]));var _5f=_5c.getValue(_5e[0],"alternate");t.assertEqual(_5f.href,"http://shaneosullivan.wordpress.com/2007/10/05/dojo-grid-has-landed/");d.callback(true);};_5c.fetch({query:{id:"http://shaneosullivan.wordpress.com/2007/10/05/dojo-grid-has-landed/"},onComplete:_5d,onError:_1.partial(_3.data.tests.stores.AtomReadStore.error,t,d)});return d;}},function testReadAPI_getFeatures(t){var _60=_3.data.tests.stores.AtomReadStore.getBlog1Store();var _61=_60.getFeatures();var _62=0;for(i in _61){t.assertTrue((i==="dojo.data.api.Read"));_62++;}t.assertTrue(_62===1);},function testReadAPI_functionConformance(t){var _63=_3.data.tests.stores.AtomReadStore.getBlog1Store();var _64=new _1.data.api.Read();var _65=true;for(i in _64){if(i.toString().charAt(0)!=="_"){var _66=_64[i];if(typeof _66==="function"){var _67=_63[i];if(!(typeof _67==="function")){_65=false;break;}}}}t.assertTrue(_65);}]);});require(["dojox/data/tests/stores/AtomReadStore"]);