/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo","dijit","dojox","dojox/rpc/Service","dojox/rpc/Rest","dojox/data/ServiceStore","dojo/data/api/Read"],function(_1,_2,_3){_1.getObject("dojox.data.tests.stores.ServiceStore",1);_3.data.tests.stores.ServiceStore.error=function(t,d,_4){d.errback(_4);};var _5=new _3.rpc.Service(_1.moduleUrl("dojox.rpc.tests.resources","test.smd"));var _6=new _3.data.ServiceStore({service:_5.jsonRestStore});doh.register("dojox.data.tests.stores.ServiceStore",[{name:"Fetch some items",timeout:10000,runTest:function(t){var d=new doh.Deferred();_6.fetch({query:"query",onComplete:function(_7,_8){t.is(4,_7.length);d.callback(true);},onError:_1.partial(_3.data.tests.stores.ServiceStore.error,doh,d)});return d;}},{name:"fetchItemByIdentity, getValue, getValues, hasAttribute,containsValue, getAttributes, getIdentity",timeout:10000,runTest:function(t){var d=new doh.Deferred();_6.fetchItemByIdentity({identity:1,onItem:function(_9,_a){t.is("Object 1",_9.name);t.is("Object 1",_6.getValue(_9,"name"));t.t(_6.hasAttribute(_9,"name"));t.is(_6.getValues(_9,"name").length,1);t.t(_6.isItem(_9));t.t(_6.isItemLoaded(_9));t.t(_6.containsValue(_9,"name","Object 1"));t.f(_6.containsValue(_9,"name","Something Else"));t.is(_6.getIdentity(_9),1);t.t(_1.indexOf(_6.getAttributes(_9),"name")>-1);t.is("default",_6.getValue(_9,"nothing","default"));d.callback(true);},onError:_1.partial(_3.data.tests.stores.ServiceStore.error,doh,d)});return d;}},{name:"createLazyItem",timeout:10000,runTest:function(t){var d=new doh.Deferred();var _b={_loadObject:function(_c){this.name="loaded";delete this._loadObject;_c(this);}};t.f(_6.isItemLoaded(_b));_6.loadItem({item:_b,onItem:function(){t.t(_6.isItemLoaded(_b));t.is(_b.name,"loaded");d.callback(true);}});return d;}},{name:"lazyItem With Fetch",timeout:10000,runTest:function(t){var d=new doh.Deferred();_6.idAttribute="id";_6.syncMode=true;_6.fetch({query:"query",onComplete:function(_d,_e){_d[0]._loadObject=function(_f){_6.fetch({query:this.id,onComplete:_f});};t.t(_6.getValue(_d[0],"testArray").length);d.callback(true);},onError:_1.partial(_3.data.tests.stores.ServiceStore.error,doh,d)});return d;}},{name:"ReadAPI:  Fetch_20_Streaming",timeout:10000,runTest:function(t){var d=new doh.Deferred();var _10=0;function _11(_12,_13){t.assertTrue(typeof _12=="number");_10++;};function _14(_15,_16){t.is(20,_10);d.callback(true);};_6.fetch({query:"bigQuery",onBegin:null,count:20,onItem:_11,onComplete:_14,onError:_1.partial(_3.data.tests.stores.ServiceStore.error,t,d)});return d;}},function testReadAPI_functionConformance(t){var _17=new _1.data.api.Read();var _18=true;for(i in _17){if(i.toString().charAt(0)!=="_"){var _19=_17[i];if(typeof _19==="function"){var _1a=_6[i];if(!(typeof _1a==="function")){_18=false;break;}}}}}]);});require(["dojox/data/tests/stores/ServiceStore"]);