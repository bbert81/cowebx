/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo","dijit","dojox","dojox/data/SnapLogicStore","dojo/data/api/Read"],function(_1,_2,_3){_1.getObject("dojox.data.tests.stores.SnapLogicStore",1);_3.data.tests.stores.SnapLogicStore.pipelineUrl=_1.moduleUrl("dojox.data.tests","stores/snap_pipeline.php").toString();_3.data.tests.stores.SnapLogicStore.pipelineSize=14;_3.data.tests.stores.SnapLogicStore.attributes=["empno","ename","job","hiredate","sal","comm","deptno"];_3.data.tests.stores.SnapLogicStore.error=function(t,d,_4){d.errback(_4);};doh.register("dojox.data.tests.stores.SnapLogicStore",[{name:"ReadAPI:  Fetch One",timeout:3000,runTest:function(t){var _5=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var d=new doh.Deferred();function _6(_7,_8){t.assertEqual(1,_7.length);d.callback(true);};_5.fetch({count:1,onComplete:_6,onError:_1.partial(_3.data.tests.stores.SnapLogicStore.error,doh,d)});return d;}},{name:"ReadAPI:  Fetch_10_Streaming",timeout:3000,runTest:function(t){var _9=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var d=new doh.Deferred();count=0;function _a(_b,_c){t.assertEqual(_3.data.tests.stores.SnapLogicStore.pipelineSize,_b);};function _d(_e,_f){t.assertTrue(_9.isItem(_e));count++;};function _10(_11,_12){t.assertEqual(10,count);t.assertTrue(_11===null);d.callback(true);};_9.fetch({onBegin:_a,count:10,onItem:_d,onComplete:_10,onError:_1.partial(_3.data.tests.stores.SnapLogicStore.error,t,d)});return d;}},{name:"ReadAPI:  Fetch Zero",timeout:3000,runTest:function(t){var _13=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var d=new doh.Deferred();function _14(_15,_16){t.assertEqual(_3.data.tests.stores.SnapLogicStore.pipelineSize,_15);d.callback(true);};_13.fetch({count:0,onBegin:_14,onError:_1.partial(_3.data.tests.stores.SnapLogicStore.error,doh,d)});return d;}},{name:"ReadAPI:  Fetch_Paging",timeout:3000,runTest:function(t){var _17=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var d=new doh.Deferred();function _18(_19,_1a){t.assertEqual(_1a.count,_19.length);_1a.start=_3.data.tests.stores.SnapLogicStore.pipelineSize/3;_1a.count=1;_1a.onComplete=_1b;_17.fetch(_1a);};function _1b(_1c,_1d){t.assertEqual(1,_1c.length);_1d.start=0;_1d.count=_3.data.tests.stores.SnapLogicStore.pipelineSize/2;_1d.onComplete=_1e;_17.fetch(_1d);};function _1e(_1f,_20){t.assertEqual(_20.count,_1f.length);_20.count=_3.data.tests.stores.SnapLogicStore.pipelineSize*2;_20.onComplete=_21;_17.fetch(_20);};function _21(_22,_23){t.assertEqual(_3.data.tests.stores.SnapLogicStore.pipelineSize,_22.length);_23.start=Math.floor(3*_3.data.tests.stores.SnapLogicStore.pipelineSize/4);_23.count=_3.data.tests.stores.SnapLogicStore.pipelineSize;_23.onComplete=_24;_17.fetch(_23);};function _24(_25,_26){t.assertEqual(_3.data.tests.stores.SnapLogicStore.pipelineSize-_26.start,_25.length);_26.start=2;_26.count=_3.data.tests.stores.SnapLogicStore.pipelineSize*10;_26.onComplete=_27;_17.fetch(_26);};function _27(_28,_29){t.assertEqual(_3.data.tests.stores.SnapLogicStore.pipelineSize-_29.start,_28.length);d.callback(true);};_17.fetch({count:5,onComplete:_18,onError:_1.partial(_3.data.tests.stores.SnapLogicStore.error,t,d)});return d;}},{name:"ReadAPI:  getLabel",timeout:3000,runTest:function(t){var _2a=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var d=new doh.Deferred();function _2b(_2c,_2d){t.assertEqual(_2c.length,1);var _2e=_2a.getLabel(_2c[0]);t.assertTrue(_2e===undefined);d.callback(true);};_2a.fetch({count:1,onComplete:_2b,onError:_1.partial(_3.data.tests.stores.SnapLogicStore.error,t,d)});return d;}},{name:"ReadAPI:  getLabelAttributes",timeout:3000,runTest:function(t){var _2f=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var d=new doh.Deferred();function _30(_31,_32){t.assertEqual(_31.length,1);var _33=_2f.getLabelAttributes(_31[0]);t.assertTrue(_33===null);d.callback(true);};_2f.fetch({count:1,onComplete:_30,onError:_1.partial(_3.data.tests.stores.SnapLogicStore.error,t,d)});return d;}},{name:"ReadAPI:  getValue",timeout:3000,runTest:function(t){var _34=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var d=new doh.Deferred();function _35(_36){t.assertEqual(1,_36.length);t.assertTrue(_34.getValue(_36[0],"empno")===7369);t.assertTrue(_34.getValue(_36[0],"ename")==="SMITH,CLERK");t.assertTrue(_34.getValue(_36[0],"sal")==800);t.assertTrue(_34.getValue(_36[0],"deptno")===20);d.callback(true);};_34.fetch({count:1,onComplete:_35,onError:_1.partial(_3.data.tests.stores.SnapLogicStore.error,t,d)});return d;}},{name:"ReadAPI:  getValues",timeout:3000,runTest:function(t){var _37=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var d=new doh.Deferred();function _38(_39){t.assertEqual(1,_39.length);for(var i=0;i<_3.data.tests.stores.SnapLogicStore.attributes.length;++i){var _3a=_37.getValues(_39[0],_3.data.tests.stores.SnapLogicStore.attributes[i]);t.assertTrue(_1.isArray(_3a));t.assertTrue(_3a[0]===_37.getValue(_39[0],_3.data.tests.stores.SnapLogicStore.attributes[i]));}d.callback(true);};_37.fetch({count:1,onComplete:_38,onError:_1.partial(_3.data.tests.stores.SnapLogicStore.error,t,d)});return d;}},{name:"ReadAPI:  isItem",timeout:3000,runTest:function(t){var _3b=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var d=new doh.Deferred();function _3c(_3d){t.assertEqual(5,_3d.length);for(var i=0;i<_3d.length;i++){t.assertTrue(_3b.isItem(_3d[i]));}d.callback(true);};_3b.fetch({count:5,onComplete:_3c,onError:_1.partial(_3.data.tests.stores.SnapLogicStore.error,t,d)});return d;}},{name:"ReadAPI:  hasAttribute",timeout:3000,runTest:function(t){var _3e=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var d=new doh.Deferred();function _3f(_40){t.assertEqual(1,_40.length);t.assertTrue(_40[0]!==null);for(var i=0;i<_3.data.tests.stores.SnapLogicStore.attributes.length;++i){t.assertTrue(_3e.hasAttribute(_40[0],_3.data.tests.stores.SnapLogicStore.attributes[i]));}t.assertTrue(!_3e.hasAttribute(_40[0],"Nothing"));t.assertTrue(!_3e.hasAttribute(_40[0],"Text"));var _41=false;try{_3e.hasAttribute(_40[0],null);}catch(e){_41=true;}t.assertTrue(_41);d.callback(true);};_3e.fetch({count:1,onComplete:_3f,onError:_1.partial(_3.data.tests.stores.SnapLogicStore.error,t,d)});return d;}},{name:"ReadAPI:  containsValue",timeout:3000,runTest:function(t){var _42=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var d=new doh.Deferred();function _43(_44){t.assertEqual(1,_44.length);var _45=_42.getValue(_44[0],"LastName");t.assertTrue(_42.containsValue(_44[0],"LastName",_45));d.callback(true);};_42.fetch({count:1,onComplete:_43,onError:_1.partial(_3.data.tests.stores.SnapLogicStore.error,t,d)});return d;}},{name:"ReadAPI:  getAttributes",timeout:3000,runTest:function(t){var _46=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var d=new doh.Deferred();function _47(_48){t.assertEqual(1,_48.length);var _49=_46.getAttributes(_48[0]);t.assertEqual(_3.data.tests.stores.SnapLogicStore.attributes.length,_49.length);for(var i=0;i<_3.data.tests.stores.SnapLogicStore.attributes.length;++i){t.assertTrue(_1.indexOf(_49,_3.data.tests.stores.SnapLogicStore.attributes[i])!==-1);}d.callback(true);};_46.fetch({count:1,onComplete:_47,onError:_1.partial(_3.data.tests.stores.SnapLogicStore.error,t,d)});return d;}},function testReadAPI_getFeatures(t){var _4a=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var _4b=_4a.getFeatures();var _4c=0;for(var i in _4b){t.assertEqual(i,"dojo.data.api.Read");_4c++;}t.assertEqual(_4c,1);},function testReadAPI_functionConformance(t){var _4d=new _3.data.SnapLogicStore({url:_3.data.tests.stores.SnapLogicStore.pipelineUrl});var _4e=new _1.data.api.Read();var _4f=true;for(var i in _4e){if(i.toString().charAt(0)!=="_"){var _50=_4e[i];if(typeof _50==="function"){var _51=_4d[i];if(!(typeof _51==="function")){_4f=false;break;}}}}t.assertTrue(_4f);}]);});require(["dojox/data/tests/stores/SnapLogicStore"]);