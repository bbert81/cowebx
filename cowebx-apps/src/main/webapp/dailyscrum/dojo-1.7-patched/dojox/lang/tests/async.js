/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo","dijit","dojox","dojox/lang/async","dojox/lang/async/timeout","dojox/lang/async/topic"],function(_1,_2,_3){_1.getObject("dojox.lang.tests.async",1);(function(){var _4=_3.lang.async,_5=_4.timeout.from,_6=50,_7=5;function _8(n){var a=[];for(var i=0;i<n;++i){a.push((Math.floor(Math.random()*_7)+1)*_6);}return a;};function _9(a){return Math.min.apply(Math,a);};function _a(a){return Math.max.apply(Math,a);};function _b(_c,ms){return function(_d){if(_c!==_d){throw new Error("Unexpected value");}return _5(ms)();};};function _e(x){return x;};function is(a,b,_f){if(a===b){return true;}if(typeof a!=typeof b){return false;}if(Object.prototype.toString.call(a)!=Object.prototype.toString.call(b)){return false;}if(Object.prototype.toString.call(a)=="[object Function]"){return false;}if(Object.prototype.toString.call(a)=="[object Array]"){if(a.length!==b.length){return false;}for(var i=0;i<a.length;++i){if(!is(a[i],b[i],_f)){return false;}return true;}}if(typeof a=="object"){if(_f){for(var i=0;i<_f.length;++i){if(_f[i]===a||_f[i]===b){return true;}}_f.push(a,b);}else{_f=[a,b];}var _10=[];for(var i in a){_10.push(i);}var _11=[];for(var i in b){_11.push(i);}_10.sort();_11.sort();if(!is(_10,_11)){return false;}for(var i=0;i<_10.length;++i){if(!is(a[_10[i]],b[_11[i]])){return false;}}return true;}return false;};var _12=_b(0,20),_13=_b(1,20),_14=_b(2,20);tests.register("dojox.lang.tests.async",[function smokeTest(){var a=_8(1),r=new _1.Deferred();_5(a[0])().addCallback(function(x){if(r==a[0]){throw new Error("smokeTest: wrong result");}r.callback();});return r;},function testSeq(){var a=_8(5),fs=_1.map(a,function(ms,i){return _b(i&&a[i-1],ms);});return _4.seq(fs)(0).addCallback(function(_15){if(a[a.length-1]!==_15){throw new Error("testSeq: wrong time");}});},function testPar(){var a=_8(5),fs=_1.map(a,function(ms){return _b(0,ms);});return _4.par(fs)(0).addCallback(function(_16){if(!is(a,_16)){throw new Error("testPar: wrong time");}});},function testAny(){var a=_8(5),min=_9(a),fs=_1.map(a,function(ms){return _b(0,ms);});return _4.any(fs)(0).addCallback(function(_17){if(min!==_17){throw new Error("testAny: wrong time");}});},function testSelect0(){return _4.select(_e,_12,_13,_14)(0);},function testSelect1(){return _4.select(_e,_12,_13,_14)(1);},function testSelect2(){return _4.select(_e,_12,_13,_14)(2);},function testIfThenT(){return _4.ifThen(_e,_13,_12)(1);},function testIfThenF(){return _4.ifThen(_e,_13,_12)(0);},function testLoop(){var _18=0;return _4.seq(_4.loop(_e,function(ms){++_18;return _5(ms-10)();}),function(){if(_18!==3){throw new Error("testLoop: wrong number of iterations");}})(30);}]);})();});require(["dojox/lang/tests/async"]);