/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo/_base/kernel","dojo/window","dojo/_base/array","dojo/_base/html","dojo/_base/window"],function(_1){function _2(_3,_4,_5,_6){var _7=_1.window.getBox();if(!_3.parentNode||String(_3.parentNode.tagName).toLowerCase()!="body"){_1.body().appendChild(_3);}var _8=null;_1.some(_4,function(_9){var _a=_9.corner;var _b=_9.pos;var _c=0;var _d={w:{"L":_7.l+_7.w-_b.x,"R":_b.x-_7.l,"M":_7.w}[_a.charAt(1)],h:{"T":_7.t+_7.h-_b.y,"B":_b.y-_7.t,"M":_7.h}[_a.charAt(0)]};if(_5){var _e=_5(_3,_9.aroundCorner,_a,_d,_6);_c=typeof _e=="undefined"?0:_e;}var _f=_3.style;var _10=_f.display;var _11=_f.visibility;if(_f.display=="none"){_f.visibility="hidden";_f.display="";}var mb=_1.marginBox(_3);_f.display=_10;_f.visibility=_11;var _12={"L":_b.x,"R":_b.x-mb.w,"M":Math.max(_7.l,Math.min(_7.l+_7.w,_b.x+(mb.w>>1))-mb.w)}[_a.charAt(1)],_13={"T":_b.y,"B":_b.y-mb.h,"M":Math.max(_7.t,Math.min(_7.t+_7.h,_b.y+(mb.h>>1))-mb.h)}[_a.charAt(0)],_14=Math.max(_7.l,_12),_15=Math.max(_7.t,_13),_16=Math.min(_7.l+_7.w,_12+mb.w),_17=Math.min(_7.t+_7.h,_13+mb.h),_18=_16-_14,_19=_17-_15;_c+=(mb.w-_18)+(mb.h-_19);if(_8==null||_c<_8.overflow){_8={corner:_a,aroundCorner:_9.aroundCorner,x:_14,y:_15,w:_18,h:_19,overflow:_c,spaceAvailable:_d};}return !_c;});if(_8.overflow&&_5){_5(_3,_8.aroundCorner,_8.corner,_8.spaceAvailable,_6);}var l=_1._isBodyLtr(),s=_3.style;s.top=_8.y+"px";s[l?"left":"right"]=(l?_8.x:_7.w-_8.x-_8.w)+"px";return _8;};return {at:function(_1a,pos,_1b,_1c){var _1d=_1.map(_1b,function(_1e){var c={corner:_1e,pos:{x:pos.x,y:pos.y}};if(_1c){c.pos.x+=_1e.charAt(1)=="L"?_1c.x:-_1c.x;c.pos.y+=_1e.charAt(0)=="T"?_1c.y:-_1c.y;}return c;});return _2(_1a,_1d);},around:function(_1f,_20,_21,_22,_23){if(typeof _20=="string"||"offsetWidth" in _20){_20=_1.position(_20,true);}var x=_20.x,y=_20.y,_24="w" in _20?_20.w:_20.width,_25="h" in _20?_20.h:_20.height;var _26=[];function _27(_28,_29){_26.push({aroundCorner:_28,corner:_29,pos:{x:{"L":x,"R":x+_24,"M":x+(_24>>1)}[_28.charAt(1)],y:{"T":y,"B":y+_25,"M":y+(_25>>1)}[_28.charAt(0)]}});};_1.forEach(_21,function(pos){var ltr=_22;switch(pos){case "above-centered":_27("TM","BM");break;case "below-centered":_27("BM","TM");break;case "after":ltr=!ltr;case "before":_27(ltr?"ML":"MR",ltr?"MR":"ML");break;case "below-alt":ltr=!ltr;case "below":_27(ltr?"BL":"BR",ltr?"TL":"TR");_27(ltr?"BR":"BL",ltr?"TR":"TL");break;case "above-alt":ltr=!ltr;case "above":_27(ltr?"TL":"TR",ltr?"BL":"BR");_27(ltr?"TR":"TL",ltr?"BR":"BL");break;default:_27(pos.aroundCorner,pos.corner);}});return _2(_1f,_26,_23,{w:_24,h:_25});}};});