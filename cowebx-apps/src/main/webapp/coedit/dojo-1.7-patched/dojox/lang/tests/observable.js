/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo","dijit","dojox","dojox/lang/observable"],function(_1,_2,_3){_1.getObject("dojox.lang.tests.observable",1);(function(){tests.register("dojox.lang.tests.observable",[function propertyAccessMakeObservable(t){var _4=[];var _5=new _3.lang.makeObservable(function(_6,i){_4.push("onRead "+i);return _6[i];},function(_7,i,_8){_4.push("onWrite "+i);_7[i]=_8;},function(_9,_a,i,_b){_4.push("onInvoke "+i);return _a[i].apply(_9,_b);});var _c={foo:"bar",test:function(){return this.foo;}};var _d=_5(_c);_4.push("returned "+_d.test());_d.foo="new";_4.push(_d.foo);t.assertEqual("onInvoke test,onRead foo,returned bar,onWrite foo,onRead foo,new",_4.join(","));},function propertyAccessObservable(t){var _e=[];var _f={foo:"bar",test:function(){return this.foo;}};var _10=_3.lang.observable(_f,function(obj,i){_e.push("onRead "+i);return obj[i];},function(obj,i,_11){_e.push("onWrite "+i);obj[i]=_11;},function(_12,obj,i,_13){_e.push("onInvoke "+i);return obj[i].apply(_12,_13);});_e.push("returned "+_10.test());_10.foo="new";_e.push(_10.foo);t.assertEqual("onInvoke test,onRead foo,returned bar,onWrite foo,onRead foo,new",_e.join(","));},function readonlyProxy(t){var _14=[];var obj={foo:"bar"};var _15=_3.lang.ReadOnlyProxy(obj);_14.push(_15.foo);_15.foo="illegal";_14.push(_15.foo);obj.foo="new";_14.push(_15.foo);t.assertEqual("bar,bar,new",_14.join(","));},function perf(t){var _16=function(obj,i){return obj[i];};var _17=new _3.lang.makeObservable(function(obj,i){return obj[i];},function(obj,i,_18){obj[i]=_18;},function(_19,obj,i,_1a){return obj[i].apply(_19,_1a);});var obj={foo:"bar",bar:"foo"};var _1b=_17(obj);var _1c=new Date().getTime();for(var i=0;i<100000;i++){var a=obj.foo;a=obj.bar;}var _1d={getValue:function(_1e,_1f,_20){var _21=_1e[_1f];if(_21 instanceof _1.Deferred){_3.rpc._sync=!_20;_21.addCallback(function(_22){_21=_22;if(_20){_20(_21);}return _21;});delete _3.rpc._sync;}else{if(_20){_20(_21);}}return _21;}};_1c=new Date().getTime();for(i=0;i<100000;i++){a=_1d.getValue(obj,"foo");a=_1d.getValue(obj,"bar");}_1c=new Date().getTime();for(i=0;i<1000000;i++){}}]);})();});require(["dojox/lang/tests/observable"]);