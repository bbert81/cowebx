/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo","dijit","dojox","dojox/dtl","dojox/dtl/Context","dojox/dtl/utils/date","dojox/date/php","dojox/string/sprintf"],function(_1,_2,_3){_1.getObject("dojox.dtl.tests.text.filter",1);doh.register("dojox.dtl.text.filter",[function test_filter_add(t){var dd=_3.dtl;var _4=new dd.Context({four:4});tpl=new dd.Template("{{ four|add:\"6\" }}");t.is("10",tpl.render(_4));_4.four="4";t.is("10",tpl.render(_4));tpl=new dd.Template("{{ four|add:\"six\" }}");t.is("4",tpl.render(_4));tpl=new dd.Template("{{ four|add:\"6.6\" }}");t.is("10",tpl.render(_4));},function test_filter_addslashes(t){var dd=_3.dtl;var _5=new dd.Context({unslashed:"Test back slashes \\, double quotes \" and single quotes '"});var _6=new dd.Template("{{ unslashed|addslashes|safe }}");t.is("Test back slashes \\\\, double quotes \\\" and single quotes \\'",_6.render(_5));},function test_filter_capfirst(t){var dd=_3.dtl;var _7=new dd.Template("{{ uncapped|capfirst }}");t.is("Cap",_7.render(new dd.Context({uncapped:"cap"})));},function test_filter_center(t){var dd=_3.dtl;var _8=new dd.Context();var _9=new dd.Template("{{ narrow|center }}");_8.narrow="even";t.is("even",_9.render(_8));_8.narrow="odd";t.is("odd",_9.render(_8));_9=new dd.Template("{{ narrow|center:\"5\" }}");_8.narrow="even";t.is("even ",_9.render(_8));_8.narrow="odd";t.is(" odd ",_9.render(_8));_9=new dd.Template("{{ narrow|center:\"6\" }}");_8.narrow="even";t.is(" even ",_9.render(_8));_8.narrow="odd";t.is(" odd  ",_9.render(_8));_9=new dd.Template("{{ narrow|center:\"12\" }}");_8.narrow="even";t.is("    even    ",_9.render(_8));_8.narrow="odd";t.is("    odd     ",_9.render(_8));},function test_filter_cut(t){var dd=_3.dtl;var _a=new dd.Context({uncut:"Apples and oranges"});var _b=new dd.Template("{{ uncut|cut }}");t.is("Apples and oranges",_b.render(_a));_b=new dd.Template("{{ uncut|cut:\"A\" }}");t.is("pples and oranges",_b.render(_a));_b=new dd.Template("{{ uncut|cut:\" \" }}");t.is("Applesandoranges",_b.render(_a));_b=new dd.Template("{{ uncut|cut:\"e\" }}");t.is("Appls and orangs",_b.render(_a));},function test_filter_date(t){var dd=_3.dtl;var _c=new dd.Context({now:new Date(2007,0,1),then:new Date(2007,1,1)});var _d=new dd.Template("{{ now|date }}");t.is(_3.dtl.utils.date.format(_c.now,"N j, Y"),_d.render(_c));_c.then=new Date(2007,0,1);_d=new dd.Template("{{ now|date:\"d\" }}");t.is("01",_d.render(_c));_d=new dd.Template("{{ now|date:\"D\" }}");t.is("Mon",_d.render(_c));_d=new dd.Template("{{ now|date:\"j\" }}");t.is("1",_d.render(_c));_d=new dd.Template("{{ now|date:\"l\" }}");t.is("Monday",_d.render(_c));_d=new dd.Template("{{ now|date:\"N\" }}");t.is("Jan.",_d.render(_c));_d=new dd.Template("{{ now|date:\"S\" }}");t.is("st",_d.render(_c));_c.now.setDate(2);t.is("nd",_d.render(_c));_c.now.setDate(3);t.is("rd",_d.render(_c));_c.now.setDate(4);t.is("th",_d.render(_c));_c.now.setDate(5);t.is("th",_d.render(_c));_c.now.setDate(6);t.is("th",_d.render(_c));_c.now.setDate(7);t.is("th",_d.render(_c));_c.now.setDate(8);t.is("th",_d.render(_c));_c.now.setDate(9);t.is("th",_d.render(_c));_c.now.setDate(10);t.is("th",_d.render(_c));_c.now.setDate(11);t.is("th",_d.render(_c));_c.now.setDate(12);t.is("th",_d.render(_c));_c.now.setDate(13);t.is("th",_d.render(_c));_c.now.setDate(14);t.is("th",_d.render(_c));_c.now.setDate(15);t.is("th",_d.render(_c));_c.now.setDate(16);t.is("th",_d.render(_c));_c.now.setDate(17);t.is("th",_d.render(_c));_c.now.setDate(18);t.is("th",_d.render(_c));_c.now.setDate(19);t.is("th",_d.render(_c));_c.now.setDate(20);t.is("th",_d.render(_c));_c.now.setDate(21);t.is("st",_d.render(_c));_c.now.setDate(22);t.is("nd",_d.render(_c));_c.now.setDate(23);t.is("rd",_d.render(_c));_c.now.setDate(24);t.is("th",_d.render(_c));_c.now.setDate(25);t.is("th",_d.render(_c));_c.now.setDate(26);t.is("th",_d.render(_c));_c.now.setDate(27);t.is("th",_d.render(_c));_c.now.setDate(28);t.is("th",_d.render(_c));_c.now.setDate(29);t.is("th",_d.render(_c));_c.now.setDate(30);t.is("th",_d.render(_c));_c.now.setDate(31);t.is("st",_d.render(_c));_c.now.setDate(1);_d=new dd.Template("{{ now|date:\"w\" }}");t.is("1",_d.render(_c));_d=new dd.Template("{{ now|date:\"z\" }}");t.is("0",_d.render(_c));_d=new dd.Template("{{ now|date:\"W\" }}");t.is("1",_d.render(_c));},function test_filter_default(t){var dd=_3.dtl;var _e=new dd.Context();tpl=new dd.Template("{{ empty|default }}");t.is("",tpl.render(_e));tpl=new dd.Template("{{ empty|default:\"full\" }}");t.is("full",tpl.render(_e));_e.empty="not empty";t.is("not empty",tpl.render(_e));},function test_filter_default_if_none(t){var dd=_3.dtl;var _f=new dd.Context();tpl=new dd.Template("{{ empty|default_if_none }}");t.is("",tpl.render(_f));tpl=new dd.Template("{{ empty|default_if_none:\"full\" }}");t.is("",tpl.render(_f));_f.empty=null;t.is("full",tpl.render(_f));_f.empty="not empty";t.is("not empty",tpl.render(_f));},function test_filter_dictsort(t){var dd=_3.dtl;var _10=new dd.Context({fruit:[{name:"lemons",toString:function(){return this.name;}},{name:"apples",toString:function(){return this.name;}},{name:"grapes",toString:function(){return this.name;}}]});tpl=new dd.Template("{{ fruit|dictsort|join:\"|\" }}");t.is("lemons|apples|grapes",tpl.render(_10));tpl=new dd.Template("{{ fruit|dictsort:\"name\"|join:\"|\" }}");t.is("apples|grapes|lemons",tpl.render(_10));},function test_filter_dictsort_reversed(t){var dd=_3.dtl;context=new dd.Context({fruit:[{name:"lemons",toString:function(){return this.name;}},{name:"apples",toString:function(){return this.name;}},{name:"grapes",toString:function(){return this.name;}}]});tpl=new dd.Template("{{ fruit|dictsortreversed:\"name\"|join:\"|\" }}");t.is("lemons|grapes|apples",tpl.render(context));},function test_filter_divisibleby(t){var dd=_3.dtl;context=new dd.Context();tpl=new dd.Template("{{ 4|divisibleby:\"2\" }}");t.is("true",tpl.render(context));context=new dd.Context({number:4});tpl=new dd.Template("{{ number|divisibleby:3 }}");t.is("false",tpl.render(context));},function test_filter_escape(t){var dd=_3.dtl;var _11=new dd.Context({unescaped:"Try & cover <all> the \"major\" 'situations' at once"});tpl=new dd.Template("{{ unescaped|escape }}");t.is("Try &amp; cover &lt;all&gt; the &quot;major&quot; &#39;situations&#39; at once",tpl.render(_11));},function test_filter_filesizeformat(t){var dd=_3.dtl;var tpl=new dd.Template("{{ 1|filesizeformat }}");t.is("1 byte",tpl.render());tpl=new dd.Template("{{ 512|filesizeformat }}");t.is("512 bytes",tpl.render());tpl=new dd.Template("{{ 1024|filesizeformat }}");t.is("1.0 KB",tpl.render());tpl=new dd.Template("{{ 2048|filesizeformat }}");t.is("2.0 KB",tpl.render());tpl=new dd.Template("{{ 1048576|filesizeformat }}");t.is("1.0 MB",tpl.render());tpl=new dd.Template("{{ 1073741824|filesizeformat }}");t.is("1.0 GB",tpl.render());},function test_filter_first(t){var dd=_3.dtl;var _12=new dd.Context({fruit:[{name:"lemons",toString:function(){return this.name;}},{name:"apples",toString:function(){return this.name;}},{name:"grapes",toString:function(){return this.name;}}]});tpl=new dd.Template("{{ fruit|first }}");t.is("lemons",tpl.render(_12));},function test_filter_fix_ampersands(t){var dd=_3.dtl;var tpl=new dd.Template("{{ \"One & Two\"|fix_ampersands|safe }}");t.is("One &amp; Two",tpl.render());},function test_filter_floatformat(t){var dd=_3.dtl;var _13=new dd.Context({num1:34.23234,num2:34});var tpl=new dd.Template("{{ num1|floatformat }}");t.is("34.2",tpl.render(_13));tpl=new dd.Template("{{ num2|floatformat }}");t.is("34",tpl.render(_13));tpl=new dd.Template("{{ num1|floatformat:3 }}");t.is("34.232",tpl.render(_13));tpl=new dd.Template("{{ num2|floatformat:3 }}");t.is("34.000",tpl.render(_13));tpl=new dd.Template("{{ num1|floatformat:-3 }}");t.is("34.2",tpl.render(_13));tpl=new dd.Template("{{ num2|floatformat:-3 }}");t.is("34",tpl.render(_13));},function test_filter_get_digit(t){var dd=_3.dtl;var _14=new dd.Context({pi:314159265});var tpl=new dd.Template("{{ pi|get_digit:1 }}");t.is("3",tpl.render(_14));tpl=new dd.Template("{{ pi|get_digit:\"2\" }}");t.is("1",tpl.render(_14));tpl=new dd.Template("{{ pi|get_digit:0 }}");t.is("314159265",tpl.render(_14));tpl=new dd.Template("{{ \"nada\"|get_digit:1 }}");t.is("0",tpl.render(_14));},function test_filter_iriencode(t){var dd=_3.dtl;var tpl=new dd.Template("{{ \"http://homepage.com/~user\"|urlencode|iriencode }}");t.is("http%3A//homepage.com/%7Euser",tpl.render());tpl=new dd.Template("{{ \"pottedmeat@dojotoolkit.org\"|iriencode }}");t.is("pottedmeat%40dojotoolkit.org",tpl.render());},function test_filter_join(t){var dd=_3.dtl;var _15=new dd.Context({items:["foo","bar","baz"]});var tpl=new dd.Template("{{ items|join }}");t.is("foo,bar,baz",tpl.render(_15));tpl=new dd.Template("{{ items|join:\"mustard\" }}");t.is("foomustardbarmustardbaz",tpl.render(_15));},function test_filter_length(t){var dd=_3.dtl;var _16=new dd.Context({fruit:[{name:"lemons",toString:function(){return this.name;}},{name:"apples",toString:function(){return this.name;}},{name:"grapes",toString:function(){return this.name;}}]});tpl=new dd.Template("{{ fruit|length }}");t.is("3",tpl.render(_16));tpl=new dd.Template("{{ fruit|first|length }}");t.is("6",tpl.render(_16));},function test_filter_length_is(t){var dd=_3.dtl;var _17=new dd.Context({fruit:[{name:"lemons",toString:function(){return this.name;}},{name:"apples",toString:function(){return this.name;}},{name:"grapes",toString:function(){return this.name;}}]});tpl=new dd.Template("{{ fruit|length_is:\"3\" }}");t.is("true",tpl.render(_17));tpl=new dd.Template("{{ fruit|length_is:\"4\" }}");t.is("false",tpl.render(_17));},function test_filter_linebreaks(t){var dd=_3.dtl;var _18=new dd.Context({unbroken:"This is just\r\n\n\ra bunch\nof text\n\n\nand such"});tpl=new dd.Template("{{ unbroken|linebreaks|safe }}");t.is("<p>This is just</p>\n\n<p>a bunch<br />of text</p>\n\n<p>and such</p>",tpl.render(_18));},function test_filter_linebreaksbr(t){var dd=_3.dtl;var _19=new dd.Context({unbroken:"This is just\r\n\n\ra bunch\nof text\n\n\nand such"});tpl=new dd.Template("{{ unbroken|linebreaksbr|safe }}");t.is("This is just<br /><br />a bunch<br />of text<br /><br /><br />and such",tpl.render(_19));},function test_filter_linenumbers(t){var dd=_3.dtl;var _1a=new dd.Context({lines:"One\nTwo\nThree\nFour\n"});var tpl=new dd.Template("{{ lines|linenumbers }}");t.is("1. One\n2. Two\n3. Three\n4. Four\n5. ",tpl.render(_1a));},function test_filter_ljust(t){var dd=_3.dtl;var _1b=new dd.Context();var tpl=new dd.Template("{{ narrow|ljust }}");_1b.narrow="even";t.is("even",tpl.render(_1b));_1b.narrow="odd";t.is("odd",tpl.render(_1b));tpl=new dd.Template("{{ narrow|ljust:\"5\" }}");_1b.narrow="even";t.is("even ",tpl.render(_1b));_1b.narrow="odd";t.is("odd  ",tpl.render(_1b));tpl=new dd.Template("{{ narrow|ljust:\"6\" }}");_1b.narrow="even";t.is("even  ",tpl.render(_1b));_1b.narrow="odd";t.is("odd   ",tpl.render(_1b));tpl=new dd.Template("{{ narrow|ljust:\"12\" }}");_1b.narrow="even";t.is("even        ",tpl.render(_1b));_1b.narrow="odd";t.is("odd         ",tpl.render(_1b));},function test_filter_lower(t){var dd=_3.dtl;var _1c=new dd.Context({mixed:"MiXeD"});var tpl=new dd.Template("{{ mixed|lower }}");t.is("mixed",tpl.render(_1c));},function test_filter_make_list(t){var dd=_3.dtl;var _1d=new dd.Context({word:"foo",number:314159265,arr:["first","second"],obj:{first:"first",second:"second"}});var tpl=new dd.Template("{{ word|make_list|join:\"|\" }} {{ number|make_list|join:\"|\" }} {{ arr|make_list|join:\"|\" }} {{ obj|make_list|join:\"|\" }}");t.is("f|o|o 3|1|4|1|5|9|2|6|5 first|second first|second",tpl.render(_1d));},function test_filter_phone2numeric(t){var dd=_3.dtl;tpl=new dd.Template("{{ \"1-800-pottedmeat\"|phone2numeric }}");t.is("1-800-7688336328",tpl.render());},function test_filter_pluralize(t){var dd=_3.dtl;var _1e=new dd.Context({animals:["bear","cougar","aardvark"]});var tpl=new dd.Template("{{ animals|length }} animal{{ animals|length|pluralize }}");t.is("3 animals",tpl.render(_1e));_1e.animals=["bear"];t.is("1 animal",tpl.render(_1e));_1e=new dd.Context({fairies:["tinkerbell","Andy Dick"]});tpl=new dd.Template("{{ fairies|length }} fair{{ fairies|length|pluralize:\"y,ies\" }}");t.is("2 fairies",tpl.render(_1e));_1e.fairies.pop();t.is("1 fairy",tpl.render(_1e));},function test_filter_pprint(t){var dd=_3.dtl;var _1f=new dd.Context({animals:["bear","cougar","aardvark"]});tpl=new dd.Template("{{ animals|pprint|safe }}");t.is("[\"bear\",\"cougar\",\"aardvark\"]",tpl.render(_1f));},function test_filter_random(t){var dd=_3.dtl;var _20=new dd.Context({fruit:[{name:"lemons",toString:function(){return this.name;}},{name:"apples",toString:function(){return this.name;}},{name:"grapes",toString:function(){return this.name;}}]});tpl=new dd.Template("{{ fruit|random }}");result=tpl.render(_20);t.t(result=="lemons"||result=="apples"||result=="grapes");var _21=false;for(var i=0;i<10;i++){if(result!=tpl.render(_20)&&result=="lemons"||result=="apples"||result=="grapes"){_21=true;break;}}t.t(_21);},function test_filter_removetags(t){var dd=_3.dtl;var _22=new dd.Context({tagged:"I'm gonna do something <script>evil</script> with the <html>filter"});tpl=new dd.Template("{{ tagged|removetags:\"script <html>\"|safe }}");t.is("I'm gonna do something evil with the filter",tpl.render(_22));},function test_filter_rjust(t){var dd=_3.dtl;var _23=new dd.Context();var tpl=new dd.Template("{{ narrow|rjust }}");_23.narrow="even";t.is("even",tpl.render(_23));_23.narrow="odd";t.is("odd",tpl.render(_23));tpl=new dd.Template("{{ narrow|rjust:\"5\" }}");_23.narrow="even";t.is(" even",tpl.render(_23));_23.narrow="odd";t.is("  odd",tpl.render(_23));tpl=new dd.Template("{{ narrow|rjust:\"6\" }}");_23.narrow="even";t.is("  even",tpl.render(_23));_23.narrow="odd";t.is("   odd",tpl.render(_23));tpl=new dd.Template("{{ narrow|rjust:\"12\" }}");_23.narrow="even";t.is("        even",tpl.render(_23));_23.narrow="odd";t.is("         odd",tpl.render(_23));},function test_filter_slice(t){var dd=_3.dtl;var _24=new dd.Context({fruit:[{name:"lemons",toString:function(){return this.name;}},{name:"apples",toString:function(){return this.name;}},{name:"grapes",toString:function(){return this.name;}}]});tpl=new dd.Template("{{ fruit|slice:\":1\"|join:\"|\" }}");t.is("lemons",tpl.render(_24));tpl=new dd.Template("{{ fruit|slice:\"1\"|join:\"|\" }}");t.is("apples|grapes",tpl.render(_24));tpl=new dd.Template("{{ fruit|slice:\"1:3\"|join:\"|\" }}");t.is("apples|grapes",tpl.render(_24));tpl=new dd.Template("{{ fruit|slice:\"\"|join:\"|\" }}");t.is("lemons|apples|grapes",tpl.render(_24));tpl=new dd.Template("{{ fruit|slice:\"-1\"|join:\"|\" }}");t.is("grapes",tpl.render(_24));tpl=new dd.Template("{{ fruit|slice:\":-1\"|join:\"|\" }}");t.is("lemons|apples",tpl.render(_24));tpl=new dd.Template("{{ fruit|slice:\"-2:-1\"|join:\"|\" }}");t.is("apples",tpl.render(_24));},function test_filter_slugify(t){var dd=_3.dtl;var _25=new dd.Context({unslugged:"Apples and oranges()"});tpl=new dd.Template("{{ unslugged|slugify }}");t.is("apples-and-oranges",tpl.render(_25));},function test_filter_stringformat(t){var dd=_3.dtl;var tpl=new dd.Template("{{ 42|stringformat:\"7.3f\" }}");t.is(" 42.000",tpl.render());},function test_filter_striptags(t){var dd=_3.dtl;var _26=new dd.Context({tagged:"I'm gonna do something <script>evil</script> with the <html>filter"});tpl=new dd.Template("{{ tagged|striptags|safe }}");t.is("I'm gonna do something evil with the filter",tpl.render(_26));},function test_filter_time(t){var dd=_3.dtl;var _27=new dd.Context({now:new Date(2007,0,1)});tpl=new dd.Template("{{ now|time }}");t.is(_3.dtl.utils.date.format(_27.now,"P"),tpl.render(_27));},function test_filter_timesince(t){var dd=_3.dtl;var _28=new dd.Context({now:new Date(2007,0,1),then:new Date(2007,1,1)});tpl=new dd.Template("{{ now|timesince:then }}");t.is("1 month",tpl.render(_28));_28.then=new Date(2007,0,5);t.is("4 days",tpl.render(_28));_28.then=new Date(2007,0,17);t.is("2 weeks",tpl.render(_28));_28.then=new Date(2008,1,1);t.is("1 year",tpl.render(_28));},function test_filter_timeuntil(t){var dd=_3.dtl;var _29=new dd.Context({now:new Date(2007,0,1),then:new Date(2007,1,1)});var tpl=new dd.Template("{{ now|timeuntil:then }}");t.is("1 month",tpl.render(_29));_29.then=new Date(2007,0,5);t.is("4 days",tpl.render(_29));_29.then=new Date(2007,0,17);t.is("2 weeks",tpl.render(_29));_29.then=new Date(2008,1,1);t.is("1 year",tpl.render(_29));},function test_filter_title(t){var dd=_3.dtl;var _2a=new dd.Context({name:"potted meat"});var tpl=new dd.Template("{{ name|title|safe }}");t.is("Potted Meat",tpl.render(_2a));_2a.name="What's going on?";t.is("What's Going On?",tpl.render(_2a));_2a.name="use\nline\nbREAKs\tand tabs";t.is("Use\nLine\nBreaks\tAnd Tabs",tpl.render(_2a));},function test_filter_truncatewords(t){var dd=_3.dtl;var _2b=new dd.Context({word:"potted meat writes a lot of tests"});var tpl=new dd.Template("{{ word|truncatewords }}");t.is(_2b.word,tpl.render(_2b));tpl=new dd.Template("{{ word|truncatewords:\"1\" }}");t.is("potted",tpl.render(_2b));tpl=new dd.Template("{{ word|truncatewords:\"2\" }}");t.is("potted meat",tpl.render(_2b));tpl=new dd.Template("{{ word|truncatewords:20\" }}");t.is(_2b.word,tpl.render(_2b));_2b.word="potted \nmeat   \nwrites  a lot of tests";tpl=new dd.Template("{{ word|truncatewords:\"3\" }}");t.is("potted \nmeat   \nwrites",tpl.render(_2b));},function test_filter_truncatewords_html(t){var dd=_3.dtl;var _2c=new dd.Context({body:"Test a string <em>that ends <i>inside a</i> tag</em> with different args",size:2});var tpl=new dd.Template("{{ body|truncatewords_html:size|safe }}");t.is("Test a ...",tpl.render(_2c));_2c.size=4;t.is("Test a string <em>that ...</em>",tpl.render(_2c));_2c.size=6;t.is("Test a string <em>that ends <i>inside ...</i></em>",tpl.render(_2c));},function test_filter_unordered_list(t){var dd=_3.dtl;var _2d=new dd.Context({states:["States",[["Kansas",[["Lawrence",[]],["Topeka",[]]]],["Illinois",[]]]]});tpl=new dd.Template("{{ states|unordered_list|safe }}");t.is("\t<li>States\n\t<ul>\n\t\t<li>Kansas\n\t\t<ul>\n\t\t\t<li>Lawrence</li>\n\t\t\t<li>Topeka</li>\n\t\t</ul>\n\t\t</li>\n\t\t<li>Illinois</li>\n\t</ul>\n\t</li>",tpl.render(_2d));},function test_filter_upper(t){var dd=_3.dtl;var _2e=new dd.Context({mixed:"MiXeD"});var tpl=new dd.Template("{{ mixed|upper }}");t.is("MIXED",tpl.render(_2e));},function test_filter_urlencode(t){var dd=_3.dtl;var tpl=new dd.Template("{{ \"http://homepage.com/~user\"|urlencode }}");t.is("http%3A//homepage.com/%7Euser",tpl.render());},function test_filter_urlize(t){var dd=_3.dtl;var _2f=new dd.Context({body:"My favorite websites are www.televisionwithoutpity.com, http://daringfireball.net and you can email me at pottedmeat@sitepen.com"});var tpl=new dd.Template("{{ body|urlize|safe }}");t.is("My favorite websites are <a href=\"http://www.televisionwithoutpity.com\" rel=\"nofollow\">www.televisionwithoutpity.com</a> <a href=\"http://daringfireball.net\" rel=\"nofollow\">http://daringfireball.net</a> and you can email me at <a href=\"mailto:pottedmeat@sitepen.com\">pottedmeat@sitepen.com</a>",tpl.render(_2f));},function test_filter_urlizetrunc(t){var dd=_3.dtl;var _30=new dd.Context({body:"My favorite websites are www.televisionwithoutpity.com, http://daringfireball.net and you can email me at pottedmeat@sitepen.com"});var tpl=new dd.Template("{{ body|urlizetrunc|safe }}");t.is("My favorite websites are <a href=\"http://www.televisionwithoutpity.com\" rel=\"nofollow\">www.televisionwithoutpity.com</a> <a href=\"http://daringfireball.net\" rel=\"nofollow\">http://daringfireball.net</a> and you can email me at <a href=\"mailto:pottedmeat@sitepen.com\">pottedmeat@sitepen.com</a>",tpl.render(_30));tpl=new dd.Template("{{ body|urlizetrunc:\"2\"|safe }}");t.is("My favorite websites are <a href=\"http://www.televisionwithoutpity.com\" rel=\"nofollow\">www.televisionwithoutpity.com</a> <a href=\"http://daringfireball.net\" rel=\"nofollow\">http://daringfireball.net</a> and you can email me at <a href=\"mailto:pottedmeat@sitepen.com\">pottedmeat@sitepen.com</a>",tpl.render(_30));tpl=new dd.Template("{{ body|urlizetrunc:\"10\"|safe }}");t.is("My favorite websites are <a href=\"http://www.televisionwithoutpity.com\" rel=\"nofollow\">www.tel...</a> <a href=\"http://daringfireball.net\" rel=\"nofollow\">http://...</a> and you can email me at <a href=\"mailto:pottedmeat@sitepen.com\">pottedmeat@sitepen.com</a>",tpl.render(_30));},function test_filter_wordcount(t){var dd=_3.dtl;var _31=new dd.Context({food:"Hot Pocket"});var tpl=new dd.Template("{{ food|wordcount }}");t.is("2",tpl.render(_31));_31.food="";t.is("0",tpl.render(_31));_31.food="A nice barbecue, maybe a little grilled veggies, some cole slaw.";t.is("11",tpl.render(_31));},function test_filter_wordwrap(t){var dd=_3.dtl;var _32=new dd.Context({body:"shrimp gumbo, shrimp pie, shrimp scampi, shrimp stew, fried shrimp, baked shrimp, shrimp o grotten, grilled shrimp, shrimp on a stick, shrimp salad, shrimp pop overs, shrimp cake, shrimp legs, shrimp stuffed eggs, shrimp cre oll, shrimp soup, creamed shrimp on toast, shrimp crapes, shrimply good crescent rolls, shrimp pizza, scalloped shrimp, boiled shrimp, shrimp cocktail"});var tpl=new dd.Template("{{ body|wordwrap }}");t.is(_32.body,tpl.render(_32));tpl=new dd.Template("{{ body|wordwrap:width }}");_32.width=10;t.is("shrimp\ngumbo,\nshrimp\npie,\nshrimp\nscampi,\nshrimp\nstew,\nfried\nshrimp,\nbaked\nshrimp,\nshrimp o\ngrotten,\ngrilled\nshrimp,\nshrimp on\na stick,\nshrimp\nsalad,\nshrimp pop\novers,\nshrimp\ncake,\nshrimp\nlegs,\nshrimp\nstuffed\neggs,\nshrimp cre\noll,\nshrimp\nsoup,\ncreamed\nshrimp on\ntoast,\nshrimp\ncrapes,\nshrimply\ngood\ncrescent\nrolls,\nshrimp\npizza,\nscalloped\nshrimp,\nboiled\nshrimp,\nshrimp\ncocktail",tpl.render(_32));tpl=new dd.Template("{{ body|wordwrap:\"80\" }}");t.is("shrimp gumbo, shrimp pie, shrimp scampi, shrimp stew, fried shrimp, baked\nshrimp, shrimp o grotten, grilled shrimp, shrimp on a stick, shrimp salad,\nshrimp pop overs, shrimp cake, shrimp legs, shrimp stuffed eggs, shrimp cre oll,\nshrimp soup, creamed shrimp on toast, shrimp crapes, shrimply good crescent\nrolls, shrimp pizza, scalloped shrimp, boiled shrimp, shrimp cocktail",tpl.render(_32));},function test_filter_yesno(t){var dd=_3.dtl;var _33=new dd.Context();tpl=new dd.Template("{{ true|yesno }}");t.is("yes",tpl.render(_33));_33=new dd.Context({test:"value"});tpl=new dd.Template("{{ test|yesno }}");t.is("yes",tpl.render(_33));tpl=new dd.Template("{{ false|yesno }}");t.is("no",tpl.render(_33));tpl=new dd.Template("{{ null|yesno }}");t.is("maybe",tpl.render(_33));tpl=new dd.Template("{{ true|yesno:\"bling,whack,soso\" }}");t.is("bling",tpl.render(_33));_33=new dd.Context({test:"value"});tpl=new dd.Template("{{ test|yesno:\"bling,whack,soso\" }}");t.is("bling",tpl.render(_33));tpl=new dd.Template("{{ false|yesno:\"bling,whack,soso\" }}");t.is("whack",tpl.render(_33));tpl=new dd.Template("{{ null|yesno:\"bling,whack,soso\" }}");t.is("soso",tpl.render(_33));tpl=new dd.Template("{{ null|yesno:\"bling,whack\" }}");t.is("whack",tpl.render(_33));},function test_filter_contrib_key(t){var dd=_3.dtl;var _34=new dd.Context({headers:["action","type"],items:[{action:"eat",type:"apple"},{action:"mash",type:"banana"}]});var tpl=new dd.Template("{% load dojox.dtl.contrib.objects %}<ul>{% for item in items %}<li><ul>{% for header in headers %}<li>{{ header }}: {{ item|key:header }}</li>{% endfor %}</ul></li>{% endfor %}</ul>");t.is("<ul><li><ul><li>action: eat</li><li>type: apple</li></ul></li><li><ul><li>action: mash</li><li>type: banana</li></ul></li></ul>",tpl.render(_34));}]);});require(["dojox/dtl/tests/text/filter"]);