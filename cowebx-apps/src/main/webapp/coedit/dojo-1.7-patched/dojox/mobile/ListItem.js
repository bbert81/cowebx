/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo/_base/array","dojo/_base/html","./_ItemBase","./TransitionEvent"],function(_1,_2,_3,_4){return dojo.declare("dojox.mobile.ListItem",dojox.mobile._ItemBase,{rightText:"",btnClass:"",btnClass2:"",anchorLabel:false,noArrow:false,selected:false,checked:false,rightIconClass:"",arrowClass:"mblDomButtonArrow",checkClass:"mblDomButtonCheck",buildRendering:function(){var a=this.anchorNode=dojo.create("A");a.className="mblListItemAnchor";var _5=this.box=dojo.create("DIV");_5.className="mblListItemTextBox";if(this.anchorLabel){_5.style.cursor="pointer";}var r=this.srcNodeRef;if(r&&!this.label){this.label="";for(var i=0,_6=r.childNodes.length;i<_6;i++){var n=r.firstChild;if(n.nodeType===3&&dojo.trim(n.nodeValue)!==""){n.nodeValue=this._cv(n.nodeValue);this.labelNode=dojo.create("SPAN");this.labelNode.appendChild(n);n=this.labelNode;}_5.appendChild(n);}}if(this.label){this.labelNode=dojo.create("SPAN",null,_5);}a.appendChild(_5);if(this.anchorLabel){_5.style.display="inline";}var li=this.domNode=this.containerNode=this.srcNodeRef||dojo.doc.createElement("LI");li.className="mblListItem"+(this.selected?" mblItemSelected":"");li.appendChild(a);},startup:function(){if(this._started){return;}this.inheritParams();var _7=this.getParent();if(this.moveTo||this.href||this.url||this.clickable){this.connect(this.anchorNode,"onclick","onClick");}this.setArrow();if(_7&&_7.select){this.connect(this.anchorNode,"onclick","onClick");}this.set("icon",this.icon);this.inherited(arguments);},onClick:function(e){var a=e.currentTarget;var li=a.parentNode;if(dojo.hasClass(li,"mblItemSelected")){return;}if(this.anchorLabel){for(var p=e.target;p.tagName!="LI";p=p.parentNode){if(p.className=="mblListItemTextBox"){dojo.addClass(p,"mblListItemTextBoxSelected");setTimeout(function(){dojo.removeClass(p,"mblListItemTextBoxSelected");},1000);this.onAnchorLabelClicked(e);return;}}}var _8=this.getParent();if(_8.select){if(_8.select==="single"){if(!this.checked){this.set("checked",true);}}else{if(_8.select==="multiple"){this.set("checked",!this.checked);}}}this.select();var _9;if(this.moveTo||this.href||this.url||this.scene){_9={moveTo:this.moveTo,href:this.href,url:this.url,scene:this.scene,transition:this.transition,transitionDir:this.transitionDir};}else{if(this.transitionOptions){_9=this.transitionOptions;}}if(_9){this.setTransitionPos(e);return new _4(this.domNode,_9,e).dispatch();}},deselect:function(){dojo.removeClass(this.domNode,"mblItemSelected");},select:function(){var _a=this.getParent();if(_a.stateful){_a.deselectAll();}else{var _b=this;setTimeout(function(){_b.deselect();},1000);}dojo.addClass(this.domNode,"mblItemSelected");},onAnchorLabelClicked:function(e){},setArrow:function(){if(this.checked){return;}var c="";var _c=this.getParent();if(this.moveTo||this.href||this.url||this.clickable){if(!this.noArrow&&!(_c&&_c.stateful)){c=this.arrowClass;}}if(c){this._setBtnClassAttr(c);}},_setIconAttr:function(_d){if(!this.getParent()){return;}this.icon=_d;var a=this.anchorNode;if(this.icon&&this.icon.indexOf("mblDomButton")===0){if(!this.iconNode){this.iconNode=dojo.create("DIV");this.domNode.insertBefore(this.iconNode,a);}this.iconNode.className=this.icon+" mblLeftButton";dojox.mobile.createDomButton(this.iconNode);dojo.removeClass(a,"mblListItemAnchorNoIcon");a.style.paddingLeft=(this.iconNode.offsetWidth+11)+"px";}else{if(this.icon&&this.icon!="none"){if(!this.iconNode){this.iconNode=dojo.create("IMG",{className:"mblListItemIcon",alt:this.alt});this.domNode.insertBefore(this.iconNode,a);}this.iconNode.src=this.icon;dojox.mobile.setupIcon(this.iconNode,this.iconPos);dojo.removeClass(a,"mblListItemAnchorNoIcon");}else{dojo.addClass(a,"mblListItemAnchorNoIcon");}}},_setBtnClass:function(_e,_f,_10){var div;if(_f){if(_f.className.match(/(mblDomButton\w+)/)){dojo.removeClass(_f,RegExp.$1);}dojo.addClass(_f,_e);div=_f;}else{div=dojo.create("DIV",{className:_e+" "+_10},this.anchorNode);}dojox.mobile.createDomButton(div);return div;},_setBtnClassAttr:function(_11){this.rightIconNode=this._setBtnClass(_11,this.rightIconNode,"mblRightButton");this._layoutRightText();},_setBtnClass2Attr:function(_12){this.rightIconNode2=this._setBtnClass(_12,this.rightIconNode2,"mblRightButton mblRightButton2");dojo.addClass(this.box,"mblListItemTextBox2");this._layoutRightText();},_setCheckedAttr:function(_13){var _14=this.getParent();if(_14.select==="single"&&_13){dojo.forEach(_14.getChildren(),function(_15){_15.set("checked",false);});}if(!this.checkNode){this._setBtnClassAttr(this.checkClass);this.checkNode=this.rightIconNode;}this.checkNode.style.display=_13?"":"none";dojo.toggleClass(this.domNode,"mblItemChecked",_13);if(this.checked!==_13){this.getParent().onCheckStateChanged(this,_13);}this.checked=_13;this._layoutRightText();},_setRightTextAttr:function(_16){this.rightText=_16;if(!this._rightTextNode){this._rightTextNode=dojo.create("DIV",{className:"mblRightText"},this.anchorNode);}this._rightTextNode.innerHTML=this._cv(_16);this._layoutRightText();},_setLabelAttr:function(_17){this.label=_17;if(!this.labelNode){this.labelNode=dojo.create("SPAN",null,box);}this.labelNode.innerHTML=this._cv(_17);},_layoutRightText:function(){if(this._rightTextNode){var w=(this.rightIconNode?this.rightIconNode.offsetWidth:0)+(this.rightIconNode2?this.rightIconNode2.offsetWidth:0);this._rightTextNode.style.right=w+11+"px";}}});});