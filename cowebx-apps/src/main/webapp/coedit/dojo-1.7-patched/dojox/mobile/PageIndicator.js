/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo/_base/html","dojo/_base/array","dojo/_base/lang","dijit/_WidgetBase","dijit/_Contained"],function(_1,_2,_3,_4,_5){return dojo.declare("dojox.mobile.PageIndicator",[dijit._WidgetBase,dijit._Contained],{refId:"",buildRendering:function(){this.domNode=this.srcNodeRef||dojo.doc.createElement("DIV");this.domNode.className="mblPageIndicator";this._tblNode=dojo.create("TABLE",{className:"mblPageIndicatorContainer"},this.domNode);this._tblNode.insertRow(-1);this.connect(this.domNode,"onclick","onClick");dojo.subscribe("/dojox/mobile/viewChanged",this,function(_6){this.reset();});},startup:function(){var _7=this;setTimeout(function(){_7.reset();},0);},reset:function(){var r=this._tblNode.rows[0];var i,c,a=[],_8;var _9=(this.refId&&dojo.byId(this.refId))||this.domNode;var _a=_9.parentNode.childNodes;for(i=0;i<_a.length;i++){c=_a[i];if(this.isView(c)){a.push(c);}}if(r.cells.length!==a.length){dojo.empty(r);for(i=0;i<a.length;i++){c=a[i];_8=dojo.create("DIV",{className:"mblPageIndicatorDot"});r.insertCell(-1).appendChild(_8);}}if(a.length===0){return;}var _b=dijit.byNode(a[0]).getShowingView();for(i=0;i<r.cells.length;i++){_8=r.cells[i].firstChild;if(a[i]===_b.domNode){dojo.addClass(_8,"mblPageIndicatorDotSelected");}else{dojo.removeClass(_8,"mblPageIndicatorDotSelected");}}},isView:function(_c){return (_c&&_c.nodeType===1&&dojo.hasClass(_c,"mblView"));},onClick:function(e){if(e.target!==this.domNode){return;}if(e.layerX<this._tblNode.offsetLeft){dojo.publish("/dojox/mobile/prevPage",[this]);}else{if(e.layerX>this._tblNode.offsetLeft+this._tblNode.offsetWidth){dojo.publish("/dojox/mobile/nextPage",[this]);}}}});});