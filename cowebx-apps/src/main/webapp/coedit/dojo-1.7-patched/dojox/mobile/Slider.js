/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo/_base/html","dojo/_base/array","dijit/_WidgetBase","dijit/form/_FormValueMixin"],function(_1,_2,_3,_4){return dojo.declare("dojox.mobile.Slider",[dijit._WidgetBase,dijit.form._FormValueMixin],{value:0,min:0,max:100,step:1,baseClass:"mblSlider",flip:false,orientation:"auto",halo:"8pt",buildRendering:function(){this.focusNode=this.domNode=dojo.create("div",{});this.valueNode=dojo.create("input",(this.srcNodeRef&&this.srcNodeRef.name)?{type:"hidden",name:this.srcNodeRef.name}:{},this.domNode,"last");var _5=dojo.create("div",{style:{position:"relative",height:"100%",width:"100%"}},this.domNode,"last");this.progressBar=dojo.create("div",{style:{position:"absolute"},"class":"mblSliderProgressBar"},_5,"last");this.touchBox=dojo.create("div",{style:{position:"absolute"},"class":"mblSliderTouchBox"},_5,"last");this.handle=dojo.create("div",{style:{position:"absolute"},"class":"mblSliderHandle"},_5,"last");this.inherited(arguments);},_setValueAttr:function(_6,_7){var _8=(this.value-this.min)*100/(this.max-this.min);this.valueNode.value=_6;this.inherited(arguments);if(!this._started){return;}this.focusNode.setAttribute("aria-valuenow",_6);var _9=(_6-this.min)*100/(this.max-this.min);var _a=this.orientation!="V";if(_7===true){dojo.addClass(this.handle,"mblSliderTransition");dojo.addClass(this.progressBar,"mblSliderTransition");}else{dojo.removeClass(this.handle,"mblSliderTransition");dojo.removeClass(this.progressBar,"mblSliderTransition");}dojo.style(this.handle,this._attrs.handleLeft,(this._reversed?(100-_9):_9)+"%");dojo.style(this.progressBar,this._attrs.width,_9+"%");},postCreate:function(){this.inherited(arguments);function _b(e){function _c(e){_1a=_d?e[this._attrs.pageX]:(e.touches?e.touches[0][this._attrs.pageX]:e[this._attrs.clientX]);_1b=_1a-_e;_1b=Math.min(Math.max(_1b,0),_f);var _10=this.step?((this.max-this.min)/this.step):_f;if(_10<=1||_10==Infinity){_10=_f;}var _11=Math.round(_1b*_10/_f);_18=(this.max-this.min)*_11/_10;_18=this._reversed?(this.max-_18):(this.min+_18);};function _12(e){e.preventDefault();dojo.hitch(this,_c)(e);this.set("value",_18,false);};function _13(e){e.preventDefault();dojo.forEach(_14,dojo.hitch(this,"disconnect"));_14=[];this.set("value",this.value,true);};e.preventDefault();var _d=e.type=="mousedown";var box=dojo.position(_15,false);var _16=dojo.style(dojo.body(),"zoom")||1;if(isNaN(_16)){_16=1;}var _17=dojo.style(_15,"zoom")||1;if(isNaN(_17)){_17=1;}var _e=box[this._attrs.x]*_17*_16+dojo._docScroll()[this._attrs.x];var _f=box[this._attrs.w]*_17*_16;dojo.hitch(this,_c)(e);if(e.target==this.touchBox){this.set("value",_18,true);}dojo.forEach(_14,dojo.disconnect);var _19=dojo.doc.documentElement;var _14=[this.connect(_19,_d?"onmousemove":"ontouchmove",_12),this.connect(_19,_d?"onmouseup":"ontouchend",_13)];};var _1a,_1b,_18;var _15=this.domNode;if(this.orientation=="auto"){this.orientation=_15.offsetHeight<=_15.offsetWidth?"H":"V";}dojo.addClass(this.domNode,dojo.map(this.baseClass.split(" "),dojo.hitch(this,function(c){return c+this.orientation;})));var _1c=this.orientation!="V";var ltr=_1c?this.isLeftToRight():false;var _1d=this.flip;this._reversed=!(_1c&&((ltr&&!_1d)||(!ltr&&_1d)))||(!_1c&&!_1d);this._attrs=_1c?{x:"x",w:"w",l:"l",r:"r",pageX:"pageX",clientX:"clientX",handleLeft:"left",left:this._reversed?"right":"left",width:"width"}:{x:"y",w:"h",l:"t",r:"b",pageX:"pageY",clientX:"clientY",handleLeft:"top",left:this._reversed?"bottom":"top",width:"height"};this.progressBar.style[this._attrs.left]="0px";this.connect(this.touchBox,"touchstart",_b);this.connect(this.touchBox,"onmousedown",_b);this.connect(this.handle,"touchstart",_b);this.connect(this.handle,"onmousedown",_b);this.startup();this.set("value",this.value);}});});