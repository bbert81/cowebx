/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo","dijit","dojox","dojox/data/CsvStore","dojo/data/util/sorter"],function(_1,_2,_3){_1.getObject("dojox.data.tests.performance.CsvStore",1);_3.data.tests.performance.CsvStore.getData=function(_4){var _5="Title, Year, Producer\n";var _6=["City of God, 2002, Katia Lund\n","Rain,, Christine Jeffs\n","2001: A Space Odyssey, 1968, Stanley Kubrick\n","\"This is a \"\"fake\"\" movie title\", 1957, Sidney Lumet\n","Alien, 1979   , Ridley Scott\n","\"The Sequel to \"\"Dances With Wolves.\"\"\", 1982, Ridley Scott\n","\"Caine Mutiny, The\", 1954, \"Dymtryk \"\"the King\"\", Edward\"\n"];var _7=_5;var i;for(i=0;i<_4;i++){var _8=Math.floor(Math.random()*7);_7+=_6[_8];}return _7;};doh.register("dojox.data.tests.performance.CsvStore",[{name:"Initial Parse and First Fetch",testType:"perf",trialDuration:100,trialDelay:50,trialIterations:50,runTest:function(){store=new _3.data.CsvStore({data:_3.data.tests.performance.CsvStore.getData(2000)});var _9=new doh.Deferred();var _a=function(_b,_c){try{doh.assertEqual(2000,_b.length);_9.callback(true);}catch(e){_9.errback(e);}};var _d=function(_e,_f){_9.errback(_e);};store.fetch({onComplete:_a,onError:_d});return _9;}},{name:"Fetch All Data",testType:"perf",trialDuration:100,trialDelay:50,trialIterations:50,setUp:function(){_3.data.tests.performance.CsvStore.store=new _3.data.CsvStore({data:_3.data.tests.performance.CsvStore.getData(2000)});_3.data.tests.performance.CsvStore.store.fetch({});},tearDown:function(){delete _3.data.tests.performance.CsvStore.store;},runTest:function(){var _10=_3.data.tests.performance.CsvStore.store;var def=new doh.Deferred();var _11=function(_12,_13){try{doh.assertEqual(2000,_12.length);def.callback(true);}catch(e){def.errback(e);}};var err=function(_14,_15){def.errback(_14);};_10.fetch({onComplete:_11,onError:err});if(!_1.isSafari){return def;}return null;}},{name:"getValue",testType:"perf",trialDuration:100,trialDelay:50,trialIterations:50,setUp:function(){_3.data.tests.performance.CsvStore.store=new _3.data.CsvStore({data:_3.data.tests.performance.CsvStore.getData(2000)});_3.data.tests.performance.CsvStore.store.fetch({});},tearDown:function(){delete _3.data.tests.performance.CsvStore.store;},runTest:function(){var _16=_3.data.tests.performance.CsvStore.store.getValue(_3.data.tests.performance.CsvStore.store._arrayOfAllItems[0],"Title");}},{name:"sort (500 rows)",testType:"perf",trialDuration:100,trialDelay:50,trialIterations:50,setUp:function(){_3.data.tests.performance.CsvStore.store=new _3.data.CsvStore({data:_3.data.tests.performance.CsvStore.getData(500)});_3.data.tests.performance.CsvStore.store.fetch();},tearDown:function(){delete _3.data.tests.performance.CsvStore.store;},runTest:function(){var _17=[{attribute:"Title"}];var _18=_3.data.tests.performance.CsvStore.store._arrayOfAllItems.slice(0,_3.data.tests.performance.CsvStore.store._arrayOfAllItems.length);_18.sort(_1.data.util.sorter.createSortFunction(_17,_3.data.tests.performance.CsvStore.store));}}]);});require(["dojox/data/tests/performance/CsvStore"]);