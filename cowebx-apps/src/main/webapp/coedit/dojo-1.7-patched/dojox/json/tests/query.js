/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

define(["dojo","dijit","dojox","dojox/json/query","dojox/jsonPath"],function(_1,_2,_3){_1.getObject("dojox.json.tests.query",1);_3.json.tests.error=function(t,d,_4){d.errback(_4);};_3.json.tests.testData={store:{"book":[{"category":"reference","author":"Nigel Rees","title":"Sayings of the Century","price":8.95},{"category":"fiction","author":"Evelyn Waugh","title":"Sword of Honour","price":12.99},{"category":"fiction","author":"Herman Melville","title":"Moby Dick","isbn":"0-553-21311-3","price":8.99},{"category":"fiction","author":"J. R. R. Tolkien","title":"The Lord of the\nRings","isbn":"0-395-19395-8","price":22.99}],"bicycle":{"color":"red","price":19.95}},"symbols":{"@.$;":5}};doh.register("dojox.json.tests.query",[{name:"$.store.book[=author]",runTest:function(t){var _5=_3.json.query(this.name,_3.json.tests.testData);_5=_1.toJson(_5);var _6="[\"Nigel Rees\",\"Evelyn Waugh\",\"Herman Melville\",\"J. R. R. Tolkien\"]";doh.assertEqual(_6,_5);}},{name:"$..author",runTest:function(t){var _7=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _8="[\"Nigel Rees\",\"Evelyn Waugh\",\"Herman Melville\",\"J. R. R. Tolkien\"]";doh.assertEqual(_8,_7);}},{name:"$.store.*",runTest:function(t){var _9=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _a="[[{\"category\":\"reference\",\"author\":\"Nigel Rees\",\"title\":\"Sayings of the Century\",\"price\":8.95},{\"category\":\"fiction\",\"author\":\"Evelyn Waugh\",\"title\":\"Sword of Honour\",\"price\":12.99},{\"category\":\"fiction\",\"author\":\"Herman Melville\",\"title\":\"Moby Dick\",\"isbn\":\"0-553-21311-3\",\"price\":8.99},{\"category\":\"fiction\",\"author\":\"J. R. R. Tolkien\",\"title\":\"The Lord of the\\nRings\",\"isbn\":\"0-395-19395-8\",\"price\":22.99}],{\"color\":\"red\",\"price\":19.95}]";doh.assertEqual(_a,_9);}},{name:"$.store..price",runTest:function(t){var _b=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _c="[8.95,12.99,8.99,22.99,19.95]";doh.assertEqual(_c,_b);}},{name:"$..book[0]?price=22.99",runTest:function(t){var _d=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _e="[{\"category\":\"fiction\",\"author\":\"J. R. R. Tolkien\",\"title\":\"The Lord of the\\nRings\",\"isbn\":\"0-395-19395-8\",\"price\":22.99}]";doh.assertEqual(_e,_d);}},{name:"$..book[0]?price>=20",runTest:function(t){var _f=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _10="[{\"category\":\"fiction\",\"author\":\"J. R. R. Tolkien\",\"title\":\"The Lord of the\\nRings\",\"isbn\":\"0-395-19395-8\",\"price\":22.99}]";doh.assertEqual(_10,_f);}},{name:"$..book[0][-1:]",runTest:function(t){var _11=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _12="[{\"category\":\"fiction\",\"author\":\"J. R. R. Tolkien\",\"title\":\"The Lord of the\\nRings\",\"isbn\":\"0-395-19395-8\",\"price\":22.99}]";doh.assertEqual(_12,_11);}},{name:"$..book[0][0,1]",runTest:function(t){var _13=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _14="[{\"category\":\"reference\",\"author\":\"Nigel Rees\",\"title\":\"Sayings of the Century\",\"price\":8.95},{\"category\":\"fiction\",\"author\":\"Evelyn Waugh\",\"title\":\"Sword of Honour\",\"price\":12.99}]";doh.assertEqual(_14,_13);}},{name:"$..book[0][:2]",runTest:function(t){var _15=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _16="[{\"category\":\"reference\",\"author\":\"Nigel Rees\",\"title\":\"Sayings of the Century\",\"price\":8.95},{\"category\":\"fiction\",\"author\":\"Evelyn Waugh\",\"title\":\"Sword of Honour\",\"price\":12.99}]";doh.assertEqual(_16,_15);}},{name:"$.store.book[=category][^?true]",runTest:function(t){var _17=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _18="[\"reference\",\"fiction\"]";doh.assertEqual(_18,_17);}},{name:"$..[^?author~'herman melville']",runTest:function(t){var _19=_1.toJson(_3.json.query(this.name,[_3.json.tests.testData,_3.json.tests.testData]));var _1a="[{\"category\":\"fiction\",\"author\":\"Herman Melville\",\"title\":\"Moby Dick\",\"isbn\":\"0-553-21311-3\",\"price\":8.99}]";doh.assertEqual(_1a,_19);}},{name:"$..[^?author='Herman*']",runTest:function(t){var _1b=_1.toJson(_3.json.query(this.name,[_3.json.tests.testData,_3.json.tests.testData]));var _1c="[{\"category\":\"fiction\",\"author\":\"Herman Melville\",\"title\":\"Moby Dick\",\"isbn\":\"0-553-21311-3\",\"price\":8.99}]";doh.assertEqual(_1c,_1b);}},{name:"$..[^?@['author']='Herman*']",runTest:function(t){var _1d=_1.toJson(_3.json.query(this.name,[_3.json.tests.testData,_3.json.tests.testData]));var _1e="[{\"category\":\"fiction\",\"author\":\"Herman Melville\",\"title\":\"Moby Dick\",\"isbn\":\"0-553-21311-3\",\"price\":8.99}]";doh.assertEqual(_1e,_1d);}},{name:"$..book[0][?(@.isbn)]",runTest:function(t){var _1f=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _20="[{\"category\":\"fiction\",\"author\":\"Herman Melville\",\"title\":\"Moby Dick\",\"isbn\":\"0-553-21311-3\",\"price\":8.99},{\"category\":\"fiction\",\"author\":\"J. R. R. Tolkien\",\"title\":\"The Lord of the\\nRings\",\"isbn\":\"0-395-19395-8\",\"price\":22.99}]";doh.assertEqual(_20,_1f);}},{name:"$..book[0][?(@.price<10)]",runTest:function(t){var _21=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _22="[{\"category\":\"reference\",\"author\":\"Nigel Rees\",\"title\":\"Sayings of the Century\",\"price\":8.95},{\"category\":\"fiction\",\"author\":\"Herman Melville\",\"title\":\"Moby Dick\",\"isbn\":\"0-553-21311-3\",\"price\":8.99}]";doh.assertEqual(_22,_21);}},{name:"$..book[0]?author=$1&price=$2",runTest:function(t){var _23=_3.json.query(this.name);var _24=_1.toJson(_23(_3.json.tests.testData,"Nigel Rees",8.95));var _25="[{\"category\":\"reference\",\"author\":\"Nigel Rees\",\"title\":\"Sayings of the Century\",\"price\":8.95}]";doh.assertEqual(_25,_24);}},{name:"$..book[0]?author=$1&price=$2",runTest:function(t){var _26=_1.toJson(_3.json.query(this.name,_3.json.tests.testData,"Herman Melville",8.99));var _27="[{\"category\":\"fiction\",\"author\":\"Herman Melville\",\"title\":\"Moby Dick\",\"isbn\":\"0-553-21311-3\",\"price\":8.99}]";doh.assertEqual(_27,_26);}},{name:"$..book[0][?(@['price']<10)]",runTest:function(t){var _28=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _29="[{\"category\":\"reference\",\"author\":\"Nigel Rees\",\"title\":\"Sayings of the Century\",\"price\":8.95},{\"category\":\"fiction\",\"author\":\"Herman Melville\",\"title\":\"Moby Dick\",\"isbn\":\"0-553-21311-3\",\"price\":8.99}]";doh.assertEqual(_29,_28);}},{name:"$..[?price<10]",runTest:function(t){var _2a=_3.json.query(this.name);var _2b=_1.toJson(_2a(_3.json.tests.testData));var _2c="[{\"category\":\"reference\",\"author\":\"Nigel Rees\",\"title\":\"Sayings of the Century\",\"price\":8.95},{\"category\":\"fiction\",\"author\":\"Herman Melville\",\"title\":\"Moby Dick\",\"isbn\":\"0-553-21311-3\",\"price\":8.99}]";doh.assertEqual(_2c,_2b);}},{name:"$.store..[?price<10]",runTest:function(t){var _2d=_3.json.query(this.name);var _2e=_1.toJson(_2d(_3.json.tests.testData));var _2f="[{\"category\":\"reference\",\"author\":\"Nigel Rees\",\"title\":\"Sayings of the Century\",\"price\":8.95},{\"category\":\"fiction\",\"author\":\"Herman Melville\",\"title\":\"Moby Dick\",\"isbn\":\"0-553-21311-3\",\"price\":8.99}]";doh.assertEqual(_2f,_2e);}},{name:"$.store.book[/category][/price][=price]",runTest:function(t){var _30=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _31="[8.95,8.99,12.99,22.99]";doh.assertEqual(_31,_30);}},{name:"$.store.book[\\category,\\price][=price]",runTest:function(t){var _32=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _33="[8.95,22.99,12.99,8.99]";doh.assertEqual(_33,_32);}},{name:"$.store.book?title='*of the*'",runTest:function(t){var _34=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _35="[{\"category\":\"reference\",\"author\":\"Nigel Rees\",\"title\":\"Sayings of the Century\",\"price\":8.95},{\"category\":\"fiction\",\"author\":\"J. R. R. Tolkien\",\"title\":\"The Lord of the\\nRings\",\"isbn\":\"0-395-19395-8\",\"price\":22.99}]";doh.assertEqual(_35,_34);}},{name:"$.store.book[?'?iction'=category][=price]",runTest:function(t){var _36=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _37="[12.99,8.99,22.99]";doh.assertEqual(_37,_36);}},{name:"$.store.book[?'?ICTion'~category][=price]",runTest:function(t){var _38=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _39="[12.99,8.99,22.99]";doh.assertEqual(_39,_38);}},{name:"$.store.book[\\price][0].price - $.store.book[/price][0].price",runTest:function(t){var _3a=_3.json.query(this.name,_3.json.tests.testData);var _3b=14;doh.assertEqual(_3b,Math.round(_3a));}},{name:"$.symbols[*]",runTest:function(t){var _3c=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _3d="[5]";doh.assertEqual(_3d,_3c);}},{name:"$.symbols['@.$;']",runTest:function(t){var _3e=_1.toJson(_3.json.query(this.name,_3.json.tests.testData));var _3f="5";doh.assertEqual(_3f,_3e);}},{name:"$.store.book[?(@.price<15)][1:3]",runTest:function(t){var _40=_1.toJson(_3.json.query("$.store.book[?(@.price<15)][1:3]",_3.json.tests.testData));var _41="[{\"category\":\"fiction\",\"author\":\"Evelyn Waugh\",\"title\":\"Sword of Honour\",\"price\":12.99},{\"category\":\"fiction\",\"author\":\"Herman Melville\",\"title\":\"Moby Dick\",\"isbn\":\"0-553-21311-3\",\"price\":8.99}]";doh.assertEqual(_41,_40);}},{name:"$.store.book[?(@.price<15)][=author]",runTest:function(t){var _42=_1.toJson(_3.json.query("$.store.book[?(@.price<15)][=author]",_3.json.tests.testData));var _43="[\"Nigel Rees\",\"Evelyn Waugh\",\"Herman Melville\"]";doh.assertEqual(_43,_42);}},{name:"$.store.book[1].category",runTest:function(t){var _44=_1.toJson(_3.json.query("$.store.book[1].category",_3.json.tests.testData));var _45="\"fiction\"";doh.assertEqual(_45,_44);}},{name:"test $.store.bicycle",runTest:function(t){var _46=_1.toJson(_3.json.query("$.store.bicycle",_3.json.tests.testData));var _47="{\"color\":\"red\",\"price\":19.95}";doh.assertEqual(_47,_46);}},{name:"test $.store.book[=category]",runTest:function(t){var _48=_1.toJson(_3.json.query("$.store.book[=category]",_3.json.tests.testData));var _49="[\"reference\",\"fiction\",\"fiction\",\"fiction\"]";doh.assertEqual(_49,_48);}},{name:"safeEval: Illegal Eval",runTest:function(t){try{var _4a=_1.toJson(_3.json.query("$.store.book[?(push(5))]",_3.json.tests.testData));doh.e("Illegal eval was permitted");}catch(e){}}},{name:"safeEval: Illegal Eval 2",runTest:function(t){try{var _4b=_1.toJson(_3.json.query("$.store.book[?(new Danger)]",_3.json.tests.testData));doh.e("Illegal eval was permitted");}catch(e){}}},{name:"safeEval: Illegal Eval 3",runTest:function(t){try{var _4c=_1.toJson(_3.json.query("$.store.book[?(@+=2)]",_3.json.tests.testData));doh.e("Illegal eval was permitted");}catch(e){}}}]);function _4d(){var _4e=[];for(var i=0;i<20000;i++){_4e.push({foo:Math.random()});}var now=new Date().getTime();var _4f=_3.jsonPath.query(_4e,"$[?(@.foo<0.01)]");alert("JSONPath"+(new Date().getTime()-now)+" "+_4f.length);now=new Date().getTime();_4f=_3.json.query("$[?(@.foo<0.01)]",_4e);alert("JSONQuery"+(new Date().getTime()-now)+" "+_4f.length);};});require(["dojox/json/tests/query"]);